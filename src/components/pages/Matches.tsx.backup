import React from 'react';
import { BaseComponentComplete } from '../base/BaseComponent';
import { Calendar, Clock, Users, Settings, Trophy, Plus, Save, X, Check, AlertCircle, MapPin, User, Target, ChevronRight } from 'lucide-react';
import { matchesApiService, Match as ApiMatch } from '../../services/matchesApi';

export interface MatchesProps {
  className?: string;
}

interface MatchForm {
  matchName: string;
  gameType: string;
  organizerName: string;
  organizerDescription: string;
  ballRules: string;
  fewRules: string;
  matchDate: string;
  matchTime: string;
  registrationEndTime: string;
  venue: string;
  locationId: string;
  entryFee: string;
  maxPlayers: string;
  moreDetails: string;
  sendNotification?: boolean;
  notificationTitle?: string;
  notificationMessage?: string;
  notificationRecipients?: string;
  selectedSkillCustomers?: number[];
}

interface Location {
  id: string;
  name: string;
  address: string;
  phone: string;
  facilities: string[];
}

interface Match {
  id: number;
  name: string;
  gameType: string;
  organizerName: string;
  organizerDescription: string;
  date: string;
  time: string;
  status: string;
  players: number;
  maxPlayers: number;
  entryFee: number;
  venue: string;
  location?: Location;
  ballRules: string;
  registeredPlayers?: any[];
  notifiedUsers?: any;
  conductedBy?: string;
  conductedByProfile?: {
    name: string;
    logo: string;
    description: string;
    contact: string;
    website?: string;
  };
  startTime?: string;
  endTime?: string;
  topPlayers?: {
    winner: {
      id: number;
      name: string;
      email: string;
      position: number;
      skillLevel: string;
      avatar?: string;
      prize?: string;
    };
    runnerUp: {
      id: number;
      name: string;
      email: string;
      position: number;
      skillLevel: string;
      avatar?: string;
      prize?: string;
    };
    thirdPlace: {
      id: number;
      name: string;
      email: string;
      position: number;
      skillLevel: string;
      avatar?: string;
      prize?: string;
    };
    fourthPlace: {
      id: number;
      name: string;
      email: string;
      position: number;
      skillLevel: string;
      avatar?: string;
      prize?: string;
    };
  };
}

interface NotificationForm {
  title: string;
  message: string;
  notificationType: 'all' | 'selected';
  selectedCustomers: number[];
  matchId?: number;
}

interface NotificationHistory {
  id: number;
  title: string;
  message: string;
  sentTo: string;
  sentCount: number;
  sentAt: string;
  matchId?: number;
  matchName?: string;
}

interface MatchesState {
  activeTab: 'schedule' | 'scheduled' | 'previous' | 'settings' | 'notifications';
  isCreatingMatch: boolean;
  isEditMode: boolean;
  selectedMatch: Match | null;
  showMatchDetails: boolean;
  showNotifiedUsers: boolean;
  showNotificationModal: boolean;
  showSendNotificationModal: boolean;
  showMatchDetailsModal: boolean; // Single popup for match details
  modalActiveTab: 'players' | 'tournament'; // Tab state for the modal
  showProfileModal: boolean; // Profile popup modal
  selectedProfile: any | null; // Selected profile data
  matchForm: MatchForm;
  selectedLocation: Location | null;
  notificationForm: NotificationForm;
  customerPage: number;
  customersPerPage: number;
  previousMatchesPage: number; // Added for previous matches pagination
  previousMatchesPerPage: number; // Added for previous matches pagination
  showGameOrganization: boolean; // Game organization section
  shuffledMatches: any[]; // Shuffled tournament matches
  currentGameMatch: Match | null; // Current match for game organization
  // API data
  scheduledMatches: ApiMatch[];
  previousMatches: ApiMatch[];
  loading: boolean;
  error: string | null;
}

export class Matches extends BaseComponentComplete<MatchesProps, MatchesState> {
  constructor(props: MatchesProps) {
    super(props);
    this.log('Matches component initialized');
  }

  protected getInitialState(): MatchesState {
    return {
      activeTab: 'schedule',
      isCreatingMatch: false,
      isEditMode: false,
      selectedMatch: null,
      showMatchDetails: false,
      showNotifiedUsers: false,
      showNotificationModal: false,
      showSendNotificationModal: false,
      matchForm: {
        matchName: '',
        gameType: '9-ball',
        organizerName: '',
        organizerDescription: '',
        ballRules: 'lastball-yes-ballinhand-yes',
        fewRules: '',
        matchDate: '',
        matchTime: '',
        registrationEndTime: '',
        venue: '',
        locationId: '',
        entryFee: '',
        maxPlayers: '',
        moreDetails: '',
        sendNotification: false,
        notificationTitle: '',
        notificationMessage: '',
        notificationRecipients: 'all',
        selectedSkillCustomers: []
      },
      selectedLocation: null,
      notificationForm: {
        title: '',
        message: '',
        notificationType: 'all',
        selectedCustomers: []
      },
      customerPage: 1,
      customersPerPage: 10,
      previousMatchesPage: 1,
      previousMatchesPerPage: 10,
      showMatchDetailsModal: false,
      modalActiveTab: 'players',
      showProfileModal: false,
      selectedProfile: null,
      showGameOrganization: false,
      shuffledMatches: [],
      currentGameMatch: null,
      // API data
      scheduledMatches: [],
      previousMatches: [],
      loading: false,
      error: null
    };
  }

  componentDidMount() {
    this.loadData();
  }

  private async loadData() {
    this.setState({ loading: true, error: null });
    try {
      const [scheduledData, previousData] = await Promise.all([
        matchesApiService.getScheduledMatches(),
        matchesApiService.getPreviousMatches()
      ]);
      
      this.setState({
        scheduledMatches: scheduledData.matches,
        previousMatches: previousData.matches,
        loading: false
      });
    } catch (error) {
      this.setState({
        error: error instanceof Error ? error.message : 'Failed to load data',
        loading: false
      });
    }
  }

  // Static data arrays
  private readonly organizationLocations: Location[] = [
    {
      id: 'loc1',
      name: 'Delhi Sports Complex - Main Branch',
      address: '123 Connaught Place, New Delhi, Delhi 110001, India',
      phone: '+91 11 2334 5678',
      facilities: ['8 Pool Tables', 'Snooker Tables', 'Restaurant', 'Parking']
    },
    {
      id: 'loc2',
      name: 'Mumbai Billiards Hall - Bandra Branch',
      address: '456 Bandra West, Mumbai, Maharashtra 400050, India',
      phone: '+91 22 2645 7890',
      facilities: ['6 Pool Tables', 'Bar', 'AC Halls', 'Valet Parking']
    }
  ];

  private readonly registeredCustomers = [
    { id: 1, name: 'Rajesh Kumar', email: 'rajesh@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 2, name: 'Priya Sharma', email: 'priya@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 3, name: 'Amit Patel', email: 'amit@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 4, name: 'Sneha Gupta', email: 'sneha@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 6, name: 'Anita Reddy', email: 'anita@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 7, name: 'Rahul Mehta', email: 'rahul@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 8, name: 'Kavya Nair', email: 'kavya@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 9, name: 'Arjun Joshi', email: 'arjun@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 10, name: 'Deepika Iyer', email: 'deepika@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 11, name: 'Suresh Kumar', email: 'suresh@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face' },
    { id: 12, name: 'Meera Patel', email: 'meera@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?w=150&h=150&fit=crop&crop=face' },
    { id: 13, name: 'Kiran Sharma', email: 'kiran@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?w=150&h=150&fit=crop&crop=face' },
    { id: 14, name: 'Ravi Verma', email: 'ravi@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150&h=150&fit=crop&crop=face' },
    { id: 15, name: 'Sunita Das', email: 'sunita@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 16, name: 'Manoj Tiwari', email: 'manoj@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 17, name: 'Pooja Agarwal', email: 'pooja@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 18, name: 'Rajesh Malhotra', email: 'rajesh.m@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 19, name: 'Neha Kapoor', email: 'neha@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 20, name: 'Vishal Jain', email: 'vishal@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 21, name: 'Shruti Bansal', email: 'shruti@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 22, name: 'Amitabh Roy', email: 'amitabh@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 23, name: 'Ritu Chawla', email: 'ritu@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 24, name: 'Sandeep Khanna', email: 'sandeep@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 25, name: 'Nisha Oberoi', email: 'nisha@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 26, name: 'Gaurav Sethi', email: 'gaurav@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 27, name: 'Preeti Goel', email: 'preeti@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 28, name: 'Harsh Vardhan', email: 'harsh@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 29, name: 'Swati Mehra', email: 'swati@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 30, name: 'Rohit Bajaj', email: 'rohit@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 31, name: 'Anjali Sinha', email: 'anjali@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 32, name: 'Kunal Dutta', email: 'kunal@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 33, name: 'Divya Rana', email: 'divya@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 34, name: 'Abhishek Pandey', email: 'abhishek@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 35, name: 'Rashmi Saxena', email: 'rashmi@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 36, name: 'Nikhil Agarwal', email: 'nikhil@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 37, name: 'Sakshi Mittal', email: 'sakshi@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 38, name: 'Varun Chopra', email: 'varun@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 39, name: 'Isha Gupta', email: 'isha@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 40, name: 'Aditya Malhotra', email: 'aditya@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 41, name: 'Tanya Singh', email: 'tanya@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 42, name: 'Rohan Kapoor', email: 'rohan@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 43, name: 'Shilpa Jain', email: 'shilpa@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 44, name: 'Akash Bansal', email: 'akash@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 45, name: 'Richa Roy', email: 'richa@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 46, name: 'Vikash Chawla', email: 'vikash@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 47, name: 'Pallavi Khanna', email: 'pallavi@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 48, name: 'Siddharth Oberoi', email: 'siddharth@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 49, name: 'Monika Sethi', email: 'monika@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 50, name: 'Rajat Goel', email: 'rajat@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 51, name: 'Karan Malhotra', email: 'karan@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 52, name: 'Pooja Singh', email: 'pooja.s@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 53, name: 'Rohit Verma', email: 'rohit.v@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 54, name: 'Sonia Agarwal', email: 'sonia@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 55, name: 'Vikram Joshi', email: 'vikram.j@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 56, name: 'Kavya Reddy', email: 'kavya.r@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 57, name: 'Arjun Sharma', email: 'arjun.s@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 58, name: 'Deepika Nair', email: 'deepika.n@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 59, name: 'Suresh Patel', email: 'suresh.p@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 60, name: 'Meera Kumar', email: 'meera.k@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face' },
    { id: 61, name: 'Kiran Gupta', email: 'kiran.g@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face' },
    { id: 62, name: 'Ravi Singh', email: 'ravi.s@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face' },
    { id: 63, name: 'Sunita Mehta', email: 'sunita.m@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face' },
    { id: 64, name: 'Manoj Nair', email: 'manoj.n@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face' },
    { id: 65, name: 'Pooja Joshi', email: 'pooja.j@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face' },
    { id: 66, name: 'Rajesh Reddy', email: 'rajesh.r@email.com', skill: 'Beginner', profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face' },
    { id: 67, name: 'Neha Sharma', email: 'neha.s@email.com', skill: 'Advanced', profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face' },
    { id: 68, name: 'Vishal Kumar', email: 'vishal.k@email.com', skill: 'Intermediate', profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face' },
    { id: 69, name: 'Shruti Patel', email: 'shruti.p@email.com', skill: 'Beginner' },
    { id: 70, name: 'Amitabh Gupta', email: 'amitabh.g@email.com', skill: 'Advanced' },
    { id: 71, name: 'Ritu Singh', email: 'ritu.s@email.com', skill: 'Intermediate' },
    { id: 72, name: 'Sandeep Mehta', email: 'sandeep.m@email.com', skill: 'Beginner' },
    { id: 73, name: 'Nisha Nair', email: 'nisha.n@email.com', skill: 'Advanced' },
    { id: 74, name: 'Gaurav Joshi', email: 'gaurav.j@email.com', skill: 'Intermediate' },
    { id: 75, name: 'Preeti Reddy', email: 'preeti.r@email.com', skill: 'Beginner' },
    { id: 76, name: 'Harsh Sharma', email: 'harsh.s@email.com', skill: 'Advanced' },
    { id: 77, name: 'Swati Kumar', email: 'swati.k@email.com', skill: 'Intermediate' },
    { id: 78, name: 'Rohit Patel', email: 'rohit.p@email.com', skill: 'Beginner' },
    { id: 79, name: 'Anjali Gupta', email: 'anjali.g@email.com', skill: 'Advanced' },
    { id: 80, name: 'Kunal Singh', email: 'kunal.s@email.com', skill: 'Intermediate' },
    { id: 81, name: 'Divya Mehta', email: 'divya.m@email.com', skill: 'Beginner' },
    { id: 82, name: 'Abhishek Nair', email: 'abhishek.n@email.com', skill: 'Advanced' },
    { id: 83, name: 'Rashmi Joshi', email: 'rashmi.j@email.com', skill: 'Intermediate' },
    { id: 84, name: 'Nikhil Reddy', email: 'nikhil.r@email.com', skill: 'Beginner' },
    { id: 85, name: 'Sakshi Sharma', email: 'sakshi.s@email.com', skill: 'Advanced' },
    { id: 86, name: 'Varun Kumar', email: 'varun.k@email.com', skill: 'Intermediate' },
    { id: 87, name: 'Isha Patel', email: 'isha.p@email.com', skill: 'Beginner' },
    { id: 88, name: 'Aditya Gupta', email: 'aditya.g@email.com', skill: 'Advanced' },
    { id: 89, name: 'Tanya Singh', email: 'tanya.s@email.com', skill: 'Intermediate' },
    { id: 90, name: 'Rohan Mehta', email: 'rohan.m@email.com', skill: 'Beginner' },
    { id: 91, name: 'Shilpa Nair', email: 'shilpa.n@email.com', skill: 'Advanced' },
    { id: 92, name: 'Akash Joshi', email: 'akash.j@email.com', skill: 'Intermediate' },
    { id: 93, name: 'Richa Reddy', email: 'richa.r@email.com', skill: 'Beginner' },
    { id: 94, name: 'Vikash Sharma', email: 'vikash.s@email.com', skill: 'Advanced' },
    { id: 95, name: 'Pallavi Kumar', email: 'pallavi.k@email.com', skill: 'Intermediate' },
    { id: 96, name: 'Siddharth Patel', email: 'siddharth.p@email.com', skill: 'Beginner' },
    { id: 97, name: 'Monika Gupta', email: 'monika.g@email.com', skill: 'Advanced' },
    { id: 98, name: 'Rajat Singh', email: 'rajat.s@email.com', skill: 'Intermediate' },
    { id: 99, name: 'Karan Mehta', email: 'karan.m@email.com', skill: 'Beginner' },
    { id: 100, name: 'Pooja Nair', email: 'pooja.n@email.com', skill: 'Advanced' }
  ];

  private readonly gameTypes = [
    { value: '8-ball', label: '8-Ball Pool' },
    { value: '9-ball', label: '9-Ball Pool' },
    { value: '10-ball', label: '10-Ball Pool' }
  ];

  private readonly ballRulesOptions = [
    { value: 'lastball-yes-ballinhand-yes', label: 'Last Ball Last Pocket: Yes, Ball in Hand: Yes' },
    { value: 'lastball-yes-ballinhand-no', label: 'Last Ball Last Pocket: Yes, Ball in Hand: No' },
    { value: 'lastball-no-ballinhand-yes', label: 'Last Ball Last Pocket: No, Ball in Hand: Yes' },
    { value: 'lastball-no-ballinhand-no', label: 'Last Ball Last Pocket: No, Ball in Hand: No' }
  ];

  // Hardcoded data - now using API data
  // private readonly scheduledMatches: Match[] = [
  //   {
  //     id: 1,
  //     name: "9-Ball Championship",
  //     gameType: "9-ball",
  //     organizerName: "Rajesh Tournament Director",
  //     organizerDescription: "Professional tournament organizer with 15+ years experience",
  //     date: "2025-10-15",
  //     time: "14:00",
  //     status: "scheduled",
  //     players: 40,
  //     maxPlayers: 50,
  //     entryFee: 50,
  //     venue: "Delhi Sports Complex - Main Branch",
  //     location: this.organizationLocations[0],
  //     ballRules: "lastball-yes-ballinhand-yes",
  //     registeredPlayers: [
  //       { id: 1, name: 'Rajesh Kumar', email: 'rajesh@email.com', skill: 'Advanced', registeredAt: '2025-10-01', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', rank: 1, rating: 2250 },
  //       { id: 2, name: 'Priya Sharma', email: 'priya@email.com', skill: 'Intermediate', registeredAt: '2025-10-02', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', rank: 20, rating: 1380 },
  //       { id: 3, name: 'Amit Patel', email: 'amit@email.com', skill: 'Expert', registeredAt: '2025-10-03', profilePic: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face', rank: 4, rating: 2100 },
  //       { id: 4, name: 'Sneha Reddy', email: 'sneha@email.com', skill: 'Pro', registeredAt: '2025-10-04', profilePic: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face', rank: 19, rating: 1450 },
  //       { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Advanced', registeredAt: '2025-10-05', profilePic: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face', rank: 2, rating: 2200 },
  //       { id: 6, name: 'Ananya Gupta', email: 'ananya@email.com', skill: 'Intermediate', registeredAt: '2025-10-06', profilePic: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=150&fit=crop&crop=face', rank: 18, rating: 1500 },
  //       { id: 7, name: 'Rohit Verma', email: 'rohit@email.com', skill: 'Expert', registeredAt: '2025-10-07', profilePic: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face', rank: 3, rating: 2150 },
  //       { id: 8, name: 'Kavya Nair', email: 'kavya@email.com', skill: 'Pro', registeredAt: '2025-10-08', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', rank: 17, rating: 1550 },
  //       { id: 9, name: 'Arjun Mehta', email: 'arjun@email.com', skill: 'Advanced', registeredAt: '2025-10-09', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face', rank: 5, rating: 2050 },
  //       { id: 10, name: 'Isha Joshi', email: 'isha@email.com', skill: 'Intermediate', registeredAt: '2025-10-10', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face', rank: 16, rating: 1600 },
  //       { id: 11, name: 'Deepak Kumar', email: 'deepak@email.com', skill: 'Expert', registeredAt: '2025-10-11', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face', rank: 6, rating: 2000 },
  //       { id: 12, name: 'Meera Iyer', email: 'meera@email.com', skill: 'Pro', registeredAt: '2025-10-12', profilePic: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=150&h=150&fit=crop&crop=face', rank: 15, rating: 1650 },
  //       { id: 13, name: 'Suresh Rao', email: 'suresh@email.com', skill: 'Advanced', registeredAt: '2025-10-13', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', rank: 7, rating: 1950 },
  //       { id: 14, name: 'Divya Agarwal', email: 'divya@email.com', skill: 'Intermediate', registeredAt: '2025-10-14', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', rank: 14, rating: 1700 },
  //       { id: 15, name: 'Ravi Sharma', email: 'ravi@email.com', skill: 'Expert', registeredAt: '2025-10-15', profilePic: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face', rank: 8, rating: 1900 },
  //       { id: 16, name: 'Pooja Desai', email: 'pooja@email.com', skill: 'Pro', registeredAt: '2025-10-16', profilePic: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face', rank: 13, rating: 1750 },
  //       { id: 17, name: 'Kiran Malhotra', email: 'kiran@email.com', skill: 'Advanced', registeredAt: '2025-10-17', profilePic: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face', rank: 9, rating: 1850 },
  //       { id: 18, name: 'Neha Kapoor', email: 'neha@email.com', skill: 'Intermediate', registeredAt: '2025-10-18', profilePic: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=150&fit=crop&crop=face', rank: 12, rating: 1800 },
  //       { id: 19, name: 'Manoj Tiwari', email: 'manoj@email.com', skill: 'Expert', registeredAt: '2025-10-19', profilePic: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face', rank: 10, rating: 1820 },
  //       { id: 20, name: 'Shruti Jain', email: 'shruti@email.com', skill: 'Pro', registeredAt: '2025-10-20', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', rank: 11, rating: 1810 },
  //       { id: 21, name: 'Gaurav Chawla', email: 'gaurav@email.com', skill: 'Advanced', registeredAt: '2025-10-21', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face', rank: 21, rating: 1350 },
  //       { id: 22, name: 'Ritu Bansal', email: 'ritu@email.com', skill: 'Intermediate', registeredAt: '2025-10-22', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face', rank: 22, rating: 1320 },
  //       { id: 23, name: 'Nikhil Agarwal', email: 'nikhil@email.com', skill: 'Expert', registeredAt: '2025-10-23', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face', rank: 23, rating: 1300 },
  //       { id: 24, name: 'Sunita Reddy', email: 'sunita@email.com', skill: 'Pro', registeredAt: '2025-10-24', profilePic: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=150&h=150&fit=crop&crop=face', rank: 24, rating: 1280 },
  //       { id: 25, name: 'Rajesh Kumar', email: 'rajesh2@email.com', skill: 'Advanced', registeredAt: '2025-10-25', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', rank: 25, rating: 1250 },
  //       { id: 26, name: 'Priya Sharma', email: 'priya2@email.com', skill: 'Intermediate', registeredAt: '2025-10-26', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', rank: 26, rating: 1220 },
  //       { id: 27, name: 'Amit Patel', email: 'amit2@email.com', skill: 'Expert', registeredAt: '2025-10-27', profilePic: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face', rank: 27, rating: 1200 },
  //       { id: 28, name: 'Sneha Reddy', email: 'sneha2@email.com', skill: 'Pro', registeredAt: '2025-10-28', profilePic: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face', rank: 28, rating: 1180 },
  //       { id: 29, name: 'Vikram Singh', email: 'vikram2@email.com', skill: 'Advanced', registeredAt: '2025-10-29', profilePic: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face', rank: 29, rating: 1150 },
  //       { id: 30, name: 'Ananya Gupta', email: 'ananya2@email.com', skill: 'Intermediate', registeredAt: '2025-10-30', profilePic: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=150&h=150&fit=crop&crop=face', rank: 30, rating: 1120 },
  //       { id: 31, name: 'Rohit Verma', email: 'rohit2@email.com', skill: 'Expert', registeredAt: '2025-11-01', profilePic: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face', rank: 31, rating: 1100 },
  //       { id: 32, name: 'Kavya Nair', email: 'kavya2@email.com', skill: 'Pro', registeredAt: '2025-11-02', profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', rank: 32, rating: 1080 },
  //       { id: 33, name: 'Arjun Mehta', email: 'arjun2@email.com', skill: 'Advanced', registeredAt: '2025-11-03', profilePic: 'https://images.unsplash.com/photo-1519345182560-3f2917c472ef?w=150&h=150&fit=crop&crop=face', rank: 33, rating: 1050 },
  //       { id: 34, name: 'Isha Joshi', email: 'isha2@email.com', skill: 'Intermediate', registeredAt: '2025-11-04', profilePic: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face', rank: 34, rating: 1020 },
  //       { id: 35, name: 'Deepak Kumar', email: 'deepak2@email.com', skill: 'Expert', registeredAt: '2025-11-05', profilePic: 'https://images.unsplash.com/photo-1507591064344-4c6ce005b128?w=150&h=150&fit=crop&crop=face', rank: 35, rating: 1000 },
  //       { id: 36, name: 'Meera Iyer', email: 'meera2@email.com', skill: 'Pro', registeredAt: '2025-11-06', profilePic: 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=150&h=150&fit=crop&crop=face', rank: 36, rating: 980 },
  //       { id: 37, name: 'Suresh Rao', email: 'suresh2@email.com', skill: 'Advanced', registeredAt: '2025-11-07', profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', rank: 37, rating: 950 },
  //       { id: 38, name: 'Divya Agarwal', email: 'divya2@email.com', skill: 'Intermediate', registeredAt: '2025-11-08', profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', rank: 38, rating: 920 },
  //       { id: 39, name: 'Ravi Sharma', email: 'ravi2@email.com', skill: 'Expert', registeredAt: '2025-11-09', profilePic: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face', rank: 39, rating: 900 },
  //       { id: 40, name: 'Pooja Desai', email: 'pooja2@email.com', skill: 'Pro', registeredAt: '2025-11-10', profilePic: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face', rank: 40, rating: 880 }
  //     ],
  //     notifiedUsers: {
  //       type: 'all',
  //       count: 3,
  //       users: this.registeredCustomers,
  //       message: 'Join our exciting 9-Ball Championship!'
  //     }
  //   }
  // ];

  // Hardcoded previousMatches data - now using API data
  // All previous matches data has been moved to src/data/previous-matches.json
  // The entire previousMatches array has been commented out
  // All data moved to src/data/previous-matches.json
          id: 2,
          name: "Priya Sharma",
          email: "priya@email.com",
          position: 2,
          skillLevel: "Intermediate",
          avatar: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",
          prize: "$1,500"
        },
        thirdPlace: {
          id: 3,
          name: "Amit Patel",
          email: "amit@email.com",
          position: 3,
          skillLevel: "Beginner",
          avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
          prize: "$1,000"
        },
        fourthPlace: {
          id: 4,
          name: "Sneha Gupta",
          email: "sneha@email.com",
          position: 4,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",
          prize: "$750"
        }
      },
      registeredPlayers: [
        { id: 1, name: 'Rajesh Kumar', email: 'rajesh@email.com', skill: 'Advanced', finalPosition: 1, profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', ranking: 1 },
        { id: 2, name: 'Priya Sharma', email: 'priya@email.com', skill: 'Intermediate', finalPosition: 2, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 2 },
        { id: 3, name: 'Amit Patel', email: 'amit@email.com', skill: 'Beginner', finalPosition: 3, profilePic: 'https://images.unsplash.com/photo-1566492031773-4f4e44671d66?w=150&h=150&fit=crop&crop=face', ranking: 3 },
        { id: 4, name: 'Sneha Gupta', email: 'sneha@email.com', skill: 'Advanced', finalPosition: 4, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 4 },
        { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Expert', finalPosition: 5, profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face', ranking: 5 },
        { id: 6, name: 'Anjali Mehta', email: 'anjali@email.com', skill: 'Intermediate', finalPosition: 6, profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', ranking: 6 },
        { id: 7, name: 'Rohit Agarwal', email: 'rohit@email.com', skill: 'Pro', finalPosition: 7, profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face', ranking: 7 },
        { id: 8, name: 'Kavya Reddy', email: 'kavya@email.com', skill: 'Amateur', finalPosition: 8, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 8 },
        { id: 9, name: 'Arjun Nair', email: 'arjun@email.com', skill: 'Advanced', finalPosition: 9, profilePic: 'https://images.unsplash.com/photo-1559548331-f9cb98d3c0f3?w=150&h=150&fit=crop&crop=face', ranking: 9 },
        { id: 10, name: 'Deepika Joshi', email: 'deepika@email.com', skill: 'Beginner', finalPosition: 10, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 10 },
        { id: 11, name: 'Manish Kumar', email: 'manish@email.com', skill: 'Pro', finalPosition: 11, profilePic: 'https://images.unsplash.com/photo-1557862921-37829c790f19?w=150&h=150&fit=crop&crop=face', ranking: 11 },
        { id: 12, name: 'Pooja Sharma', email: 'pooja@email.com', skill: 'Intermediate', finalPosition: 12, profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', ranking: 12 },
        { id: 13, name: 'Suresh Patel', email: 'suresh@email.com', skill: 'Expert', finalPosition: 13, profilePic: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face', ranking: 13 },
        { id: 14, name: 'Neha Gupta', email: 'neha@email.com', skill: 'Amateur', finalPosition: 14, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 14 },
        { id: 15, name: 'Rajesh Verma', email: 'rajesh.v@email.com', skill: 'Advanced', finalPosition: 15, profilePic: 'https://images.unsplash.com/photo-1522075469751-3847ae2b6d85?w=150&h=150&fit=crop&crop=face', ranking: 15 },
        { id: 16, name: 'Sunita Devi', email: 'sunita@email.com', skill: 'Beginner', finalPosition: 16, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 16 },
        { id: 17, name: 'Vishal Jain', email: 'vishal@email.com', skill: 'Pro', finalPosition: 17, profilePic: 'https://images.unsplash.com/photo-1463453091185-61582044d556?w=150&h=150&fit=crop&crop=face', ranking: 17 },
        { id: 18, name: 'Meera Singh', email: 'meera@email.com', skill: 'Intermediate', finalPosition: 18, profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', ranking: 18 },
        { id: 19, name: 'Karan Malhotra', email: 'karan@email.com', skill: 'Expert', finalPosition: 19, profilePic: 'https://images.unsplash.com/photo-1531427186611-ecfd6d936c79?w=150&h=150&fit=crop&crop=face', ranking: 19 },
        { id: 20, name: 'Shilpa Iyer', email: 'shilpa@email.com', skill: 'Amateur', finalPosition: 20, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 20 },
        { id: 21, name: 'Nikhil Rao', email: 'nikhil@email.com', skill: 'Advanced', finalPosition: 21, profilePic: 'https://images.unsplash.com/photo-1547425260-76bcadfb4f2c?w=150&h=150&fit=crop&crop=face', ranking: 21 },
        { id: 22, name: 'Ritu Agarwal', email: 'ritu@email.com', skill: 'Beginner', finalPosition: 22, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 22 },
        { id: 23, name: 'Gaurav Sharma', email: 'gaurav@email.com', skill: 'Pro', finalPosition: 23, profilePic: 'https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?w=150&h=150&fit=crop&crop=face', ranking: 23 },
        { id: 24, name: 'Preeti Nair', email: 'preeti@email.com', skill: 'Intermediate', finalPosition: 24, profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', ranking: 24 },
        { id: 25, name: 'Ravi Kumar', email: 'ravi@email.com', skill: 'Expert', finalPosition: 25, profilePic: 'https://images.unsplash.com/photo-1552058544-f2b08422138a?w=150&h=150&fit=crop&crop=face', ranking: 25 },
        { id: 26, name: 'Divya Reddy', email: 'divya@email.com', skill: 'Amateur', finalPosition: 26, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 26 },
        { id: 27, name: 'Sandeep Joshi', email: 'sandeep@email.com', skill: 'Advanced', finalPosition: 27, profilePic: 'https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=150&h=150&fit=crop&crop=face', ranking: 27 },
        { id: 28, name: 'Anita Verma', email: 'anita@email.com', skill: 'Beginner', finalPosition: 28, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 28 },
        { id: 29, name: 'Ajay Jain', email: 'ajay@email.com', skill: 'Pro', finalPosition: 29, profilePic: 'https://images.unsplash.com/photo-1507114883641-90c2c6e04388?w=150&h=150&fit=crop&crop=face', ranking: 29 },
        { id: 30, name: 'Rekha Singh', email: 'rekha@email.com', skill: 'Intermediate', finalPosition: 30, profilePic: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face', ranking: 30 }
      ],
      notifiedUsers: {
        type: 'all',
        count: 3,
        users: this.registeredCustomers,
        message: 'Summer championship is here!'
      }
    },
    {
      id: 4,
      name: "Winter 8-Ball Championship",
      gameType: "8-ball",
      organizerName: "Rajesh Championship",
      organizerDescription: "Professional tournament organizer",
      date: "2025-08-20",
      time: "14:00",
      status: "completed",
      players: 24,
      maxPlayers: 24,
      entryFee: 100,
      venue: "Mumbai Billiards Club",
      ballRules: "lastball-yes-ballinhand-yes",
      conductedBy: "Mumbai Pool Association",
      conductedByProfile: {
        name: "Mumbai Pool Association",
        logo: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=100&h=100&fit=crop&crop=center",
        profilePic: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
        description: "Mumbai's leading pool organization",
        contact: "+91 98765 43210",
        website: "www.mumbaipool.org",
        position: "Tournament Director",
        skillLevel: "Pro"
      },
      startTime: "2:00 PM",
      endTime: "8:45 PM",
      topPlayers: {
        winner: {
          id: 2,
          name: "Priya Sharma",
          email: "priya@email.com",
          position: 1,
          skillLevel: "Intermediate",
          avatar: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",
          prize: "$1,800"
        },
        runnerUp: {
          id: 5,
          name: "Vikram Singh",
          email: "vikram@email.com",
          position: 2,
          skillLevel: "Expert",
          avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",
          prize: "$1,200"
        },
        thirdPlace: {
          id: 4,
          name: "Sneha Gupta",
          email: "sneha@email.com",
          position: 3,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",
          prize: "$800"
        },
        fourthPlace: {
          id: 7,
          name: "Rohit Agarwal",
          email: "rohit@email.com",
          position: 4,
          skillLevel: "Pro",
          avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
          prize: "$600"
        }
      },
      registeredPlayers: [
        { id: 2, name: 'Priya Sharma', email: 'priya@email.com', skill: 'Intermediate', finalPosition: 1, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 1 },
        { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Expert', finalPosition: 2, profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face', ranking: 2 },
        { id: 4, name: 'Sneha Gupta', email: 'sneha@email.com', skill: 'Advanced', finalPosition: 3, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 3 },
        { id: 7, name: 'Rohit Agarwal', email: 'rohit@email.com', skill: 'Pro', finalPosition: 4, profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face', ranking: 4 }
      ],
      notifiedUsers: {
        type: 'all',
        count: 24,
        users: [],
        message: 'Winter championship completed!'
      }
    },
    {
      id: 5,
      name: "Spring 10-Ball Masters",
      gameType: "10-ball",
      organizerName: "Amit Sports Club",
      organizerDescription: "Professional tournament organizer",
      date: "2025-07-10",
      time: "16:00",
      status: "completed",
      players: 16,
      maxPlayers: 16,
      entryFee: 125,
      venue: "Bangalore Pool Center",
      ballRules: "lastball-yes-ballinhand-yes",
      conductedBy: "Karnataka Billiards Society",
      conductedByProfile: {
        name: "Karnataka Billiards Society",
        logo: "https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=100&h=100&fit=crop&crop=center",
        profilePic: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",
        description: "Karnataka's premier billiards society",
        contact: "+91 87654 32109",
        website: "www.karnatakabilliards.org",
        position: "Tournament Director",
        skillLevel: "Advanced"
      },
      startTime: "4:00 PM",
      endTime: "10:15 PM",
      topPlayers: {
        winner: {
          id: 5,
          name: "Vikram Singh",
          email: "vikram@email.com",
          position: 1,
          skillLevel: "Expert",
          avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",
          prize: "$3,200"
        },
        runnerUp: {
          id: 1,
          name: "Rajesh Kumar",
          email: "rajesh@email.com",
          position: 2,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
          prize: "$2,000"
        },
        thirdPlace: {
          id: 4,
          name: "Sneha Gupta",
          email: "sneha@email.com",
          position: 3,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",
          prize: "$1,200"
        },
        fourthPlace: {
          id: 7,
          name: "Rohit Agarwal",
          email: "rohit@email.com",
          position: 4,
          skillLevel: "Pro",
          avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",
          prize: "$800"
        }
      },
      registeredPlayers: [
        { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Expert', finalPosition: 1, profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face', ranking: 1 },
        { id: 1, name: 'Rajesh Kumar', email: 'rajesh@email.com', skill: 'Advanced', finalPosition: 2, profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', ranking: 2 },
        { id: 4, name: 'Sneha Gupta', email: 'sneha@email.com', skill: 'Advanced', finalPosition: 3, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 3 },
        { id: 7, name: 'Rohit Agarwal', email: 'rohit@email.com', skill: 'Pro', finalPosition: 4, profilePic: 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face', ranking: 4 }
      ],
      notifiedUsers: {
        type: 'all',
        count: 16,
        users: [],
        message: 'Spring masters tournament completed!'
      }
    },
    {
      id: 6,
      name: "Monsoon Straight Pool Classic",
      gameType: "straight-pool",
      organizerName: "Sneha Game Center",
      organizerDescription: "Professional tournament organizer",
      date: "2025-06-05",
      time: "11:00",
      status: "completed",
      players: 20,
      maxPlayers: 20,
      entryFee: 150,
      venue: "Kolkata Game Zone",
      ballRules: "lastball-yes-ballinhand-yes",
      conductedBy: "West Bengal Pool Federation",
      conductedByProfile: {
        name: "West Bengal Pool Federation",
        logo: "https://images.unsplash.com/photo-1541534741688-6078c6bfb5c5?w=100&h=100&fit=crop&crop=center",
        profilePic: "https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?w=150&h=150&fit=crop&crop=face",
        description: "West Bengal's official pool federation",
        contact: "+91 76543 21098",
        website: "www.westbengalpool.org",
        position: "Tournament Director",
        skillLevel: "Expert"
      },
      startTime: "11:00 AM",
      endTime: "7:20 PM",
      topPlayers: {
        winner: {
          id: 4,
          name: "Sneha Gupta",
          email: "sneha@email.com",
          position: 1,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",
          prize: "$2,800"
        },
        runnerUp: {
          id: 2,
          name: "Priya Sharma",
          email: "priya@email.com",
          position: 2,
          skillLevel: "Intermediate",
          avatar: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",
          prize: "$1,800"
        },
        thirdPlace: {
          id: 5,
          name: "Vikram Singh",
          email: "vikram@email.com",
          position: 3,
          skillLevel: "Expert",
          avatar: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",
          prize: "$1,200"
        },
        fourthPlace: {
          id: 1,
          name: "Rajesh Kumar",
          email: "rajesh@email.com",
          position: 4,
          skillLevel: "Advanced",
          avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",
          prize: "$900"
        }
      },
      registeredPlayers: [
        { id: 4, name: 'Sneha Gupta', email: 'sneha@email.com', skill: 'Advanced', finalPosition: 1, profilePic: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face', ranking: 1 },
        { id: 2, name: 'Priya Sharma', email: 'priya@email.com', skill: 'Intermediate', finalPosition: 2, profilePic: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face', ranking: 2 },
        { id: 5, name: 'Vikram Singh', email: 'vikram@email.com', skill: 'Expert', finalPosition: 3, profilePic: 'https://images.unsplash.com/photo-1600180758890-6b94519a8ba6?w=150&h=150&fit=crop&crop=face', ranking: 3 },
        { id: 1, name: 'Rajesh Kumar', email: 'rajesh@email.com', skill: 'Advanced', finalPosition: 4, profilePic: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face', ranking: 4 }
      ],
      notifiedUsers: {
        type: 'all',
        count: 20,
        users: [],
        message: 'Monsoon classic tournament completed!'
      }
    },
    // Adding 96 more previous matches
    ...Array.from({ length: 99 }, (_, index) => {
      const matchId = 4 + index;
      const gameTypes = ['9-ball', '8-ball', '10-ball', 'straight-pool', 'one-pocket'];
      const formats = ['race-to-7', 'race-to-5', 'race-to-9', 'single-elimination', 'double-elimination'];
      const statuses = ['completed'];
      const entryFees = [50, 75, 100, 125, 150];
      const playerCounts = [8, 16, 24, 32];
      const venues = ['Delhi Sports Complex', 'Mumbai Billiards Club', 'Chennai Sports Club', 'Bangalore Pool Center', 'Kolkata Game Zone'];
      const organizers = ['Priya Tournament Pro', 'Rajesh Championship', 'Amit Sports Club', 'Sneha Game Center', 'Vikram Pool Academy'];
      
      const gameType = gameTypes[Math.floor(Math.random() * gameTypes.length)];
      const format = formats[Math.floor(Math.random() * formats.length)];
      const entryFee = entryFees[Math.floor(Math.random() * entryFees.length)];
      const maxPlayers = playerCounts[Math.floor(Math.random() * playerCounts.length)];
      const actualPlayers = Math.floor(Math.random() * maxPlayers) + 4;
      const venue = venues[Math.floor(Math.random() * venues.length)];
      const organizer = organizers[Math.floor(Math.random() * organizers.length)];
      
      // Generate random date within the last 6 months
      const randomDate = new Date();
      randomDate.setDate(randomDate.getDate() - Math.floor(Math.random() * 180));
      
      // Create random players for this match
      const shuffledCustomers = [...this.registeredCustomers].sort(() => Math.random() - 0.5);
      const matchPlayers = shuffledCustomers.slice(0, actualPlayers).map((player, playerIndex) => ({
        ...player,
        finalPosition: playerIndex + 1,
        ranking: playerIndex + 1
      }));
      
      return {
        id: matchId,
        name: `${gameType.charAt(0).toUpperCase() + gameType.slice(1)} Championship ${matchId}`,
        gameType,
        organizerName: organizer,
        organizerDescription: "Professional tournament organizer",
        format,
        date: randomDate.toISOString().split('T')[0],
        time: `${Math.floor(Math.random() * 12) + 9}:${Math.random() > 0.5 ? '00' : '30'}`,
        registrationEnd: new Date(randomDate.getTime() - 2 * 60 * 60 * 1000).toISOString(),
        status: statuses[0],
        players: actualPlayers,
        maxPlayers,
        entryFee,
        venue,
        ballRules: "lastball-yes-ballinhand-yes",
        registeredPlayers: matchPlayers,
        notifiedUsers: {
          type: 'all',
          count: actualPlayers,
          users: matchPlayers,
          message: `Join our ${gameType} tournament!`
        }
      };
    })
  ];

  private readonly notificationHistory: NotificationHistory[] = [
    {
      id: 1,
      title: "9-Ball Championship Reminder",
      message: "Don't forget! The 9-Ball Championship starts tomorrow at 2:00 PM. Good luck!",
      sentTo: "All Customers",
      sentCount: 3,
      sentAt: "2025-10-14T10:00:00",
      matchId: 1,
      matchName: "9-Ball Championship"
    },
    {
      id: 2,
      title: "Tournament Results Available",
      message: "The Summer 9-Ball Cup results are now available. Check your performance!",
      sentTo: "All Customers",
      sentCount: 3,
      sentAt: "2025-09-16T15:30:00",
      matchId: 3,
      matchName: "Summer 9-Ball Cup"
    },
    {
      id: 3,
      title: "Welcome New Tournament",
      message: "Join our exciting new 8-Ball tournament next weekend!",
      sentTo: "Selected Customers",
      sentCount: 2,
      sentAt: "2025-10-10T09:00:00"
    }
  ];

  // Class methods
  private handleInputChange = (field: string, value: string | boolean): void => {
    this.setState({
      matchForm: {
        ...this.state.matchForm,
        [field]: value
      }
    });

    if (field === 'locationId') {
      const location = this.organizationLocations.find(loc => loc.id === value);
      this.setState({ selectedLocation: location || null });
      if (location) {
        this.setState({
          matchForm: {
            ...this.state.matchForm,
            venue: location.name
          }
        });
      }
    }
  };

  private handleSubmit = (): void => {
    const { matchForm } = this.state;
    
    console.log('Match scheduled:', matchForm);
    
    // Handle notification if enabled
    if (matchForm.sendNotification && matchForm.notificationTitle && matchForm.notificationMessage) {
      let recipients: any[] = [];
      let recipientCount = 0;
      
      if (matchForm.notificationRecipients === 'all') {
        recipients = this.registeredCustomers;
        recipientCount = recipients.length;
      } else if (matchForm.selectedSkillCustomers && matchForm.selectedSkillCustomers.length > 0) {
        recipients = this.registeredCustomers.filter(customer => 
          matchForm.selectedSkillCustomers!.includes(customer.id)
        );
        recipientCount = recipients.length;
      }
      
      console.log('Notification sent:', {
        title: matchForm.notificationTitle,
        message: matchForm.notificationMessage,
        recipients: recipientCount,
        recipientType: matchForm.notificationRecipients,
        selectedCustomers: matchForm.selectedSkillCustomers
      });
      
      if (recipientCount > 0) {
        alert(`Tournament created successfully! Notification sent to ${recipientCount} customers.`);
      } else {
        alert('Tournament created successfully! No customers selected for notification.');
      }
    } else {
      alert('Tournament created successfully!');
    }
    
    this.setState({
      isCreatingMatch: false,
      isEditMode: false,
      matchForm: {
        matchName: '',
        gameType: '9-ball',
        organizerName: '',
        organizerDescription: '',
        ballRules: 'lastball-yes-ballinhand-yes',
        fewRules: '',
        matchDate: '',
        matchTime: '',
        registrationEndTime: '',
        venue: '',
        locationId: '',
        entryFee: '',
        maxPlayers: '',
        moreDetails: '',
        sendNotification: false,
        notificationTitle: '',
        notificationMessage: '',
        notificationRecipients: 'all',
        selectedSkillCustomers: []
      },
      selectedLocation: null
    });
  };

  private getNotificationRecipients = (recipientType: string): any[] => {
    switch (recipientType) {
      case 'advanced':
        return this.registeredCustomers.filter(customer => customer.skill === 'Advanced');
      case 'intermediate':
        return this.registeredCustomers.filter(customer => customer.skill === 'Intermediate');
      case 'beginner':
        return this.registeredCustomers.filter(customer => customer.skill === 'Beginner');
      default:
        return this.registeredCustomers;
    }
  };

  private getFilteredCustomers = (): any[] => {
    const { notificationRecipients } = this.state.matchForm;
    if (!notificationRecipients || notificationRecipients === 'all') {
      return this.registeredCustomers;
    }
    return this.registeredCustomers.filter(customer => customer.skill === notificationRecipients.charAt(0).toUpperCase() + notificationRecipients.slice(1));
  };

  private handleSkillCustomerSelection = (customerId: number, isSelected: boolean): void => {
    const { selectedSkillCustomers } = this.state.matchForm;
    const updatedCustomers = isSelected
      ? [...(selectedSkillCustomers || []), customerId]
      : (selectedSkillCustomers || []).filter(id => id !== customerId);

    this.setState({
      matchForm: {
        ...this.state.matchForm,
        selectedSkillCustomers: updatedCustomers
      }
    });
  };

  private handleSelectAllSkillCustomers = (): void => {
    const paginatedCustomers = this.getPaginatedCustomers();
    const currentSelected = this.state.matchForm.selectedSkillCustomers || [];
    const newSelections = paginatedCustomers.map(customer => customer.id);
    const updatedSelections = [...new Set([...currentSelected, ...newSelections])];
    
    this.setState({
      matchForm: {
        ...this.state.matchForm,
        selectedSkillCustomers: updatedSelections
      }
    });
  };

  private handleClearSkillCustomerSelection = (): void => {
    const paginatedCustomers = this.getPaginatedCustomers();
    const paginatedIds = paginatedCustomers.map(customer => customer.id);
    const currentSelected = this.state.matchForm.selectedSkillCustomers || [];
    const updatedSelections = currentSelected.filter(id => !paginatedIds.includes(id));
    
    this.setState({
      matchForm: {
        ...this.state.matchForm,
        selectedSkillCustomers: updatedSelections
      }
    });
  };

  // Previous matches pagination methods
  private handlePreviousMatchesPageChange = (page: number): void => {
    this.setState({
      previousMatchesPage: page
    });
  };

  private getPaginatedPreviousMatches = (): ApiMatch[] => {
    const { previousMatchesPage, previousMatchesPerPage } = this.state;
    const startIndex = (previousMatchesPage - 1) * previousMatchesPerPage;
    const endIndex = startIndex + previousMatchesPerPage;
    return this.state.previousMatches.slice(startIndex, endIndex);
  };

  private getPreviousMatchesTotalPages = (): number => {
    return Math.ceil(this.state.previousMatches.length / this.state.previousMatchesPerPage);
  };

  private getPreviousMatchesPageNumbers = (): (number | string)[] => {
    const currentPage = this.state.previousMatchesPage;
    const totalPages = this.getPreviousMatchesTotalPages();
    const pageNumbers: (number | string)[] = [];

    if (totalPages <= 7) {
      // Show all pages if 7 or fewer
      for (let i = 1; i <= totalPages; i++) {
        pageNumbers.push(i);
      }
    } else {
      // Always show first page
      pageNumbers.push(1);

      if (currentPage <= 4) {
        // Show first 5 pages, then ellipsis, then last page
        for (let i = 2; i <= 5; i++) {
          pageNumbers.push(i);
        }
        pageNumbers.push('...');
        pageNumbers.push(totalPages);
      } else if (currentPage >= totalPages - 3) {
        // Show first page, ellipsis, then last 5 pages
        pageNumbers.push('...');
        for (let i = totalPages - 4; i <= totalPages; i++) {
          pageNumbers.push(i);
        }
      } else {
        // Show first page, ellipsis, current-1, current, current+1, ellipsis, last page
        pageNumbers.push('...');
        pageNumbers.push(currentPage - 1);
        pageNumbers.push(currentPage);
        pageNumbers.push(currentPage + 1);
        pageNumbers.push('...');
        pageNumbers.push(totalPages);
      }
    }
    return pageNumbers;
  };

  // Match details modal methods
  private handleShowMatchDetailsModal = async (match: ApiMatch): Promise<void> => {
    try {
      // Fetch detailed match data from API
      const detailedMatch = await matchesApiService.getMatchDetails(match.id);
      this.setState({
        selectedMatch: detailedMatch,
        showMatchDetailsModal: true
      });
    } catch (error) {
      console.error('Error fetching match details:', error);
      // Fallback to using the provided match data
      this.setState({
        selectedMatch: match,
        showMatchDetailsModal: true
      });
    }
  };

  private handleCloseMatchDetailsModal = (): void => {
    this.setState({
      showMatchDetailsModal: false,
      selectedMatch: null
    });
  };

  private handleOpenProfileModal = async (profile: any): Promise<void> => {
    // If profile has an ID, fetch detailed profile from API
    if (profile?.id) {
      try {
        const detailedProfile = await matchesApiService.getPlayerProfile(profile.id);
        this.setState({
          selectedProfile: { ...profile, ...detailedProfile },
          showProfileModal: true
        });
      } catch (error) {
        console.error('Error fetching player profile:', error);
        // Fallback to using the provided profile data
        this.setState({
          selectedProfile: profile,
          showProfileModal: true
        });
      }
    } else {
      // For profiles without ID (like conducted by profiles), use as-is
      this.setState({
        selectedProfile: profile,
        showProfileModal: true
      });
    }
  };

  private handleGameInitiate = (match: Match): void => {
    this.setState({
      showGameOrganization: true,
      currentGameMatch: match,
      shuffledMatches: []
    });
  };

  private handleShuffleGame = async (): Promise<void> => {
    if (!this.state.currentGameMatch?.registeredPlayers) {
      console.log('No current game match or registered players found');
      return;
    }
    
    console.log('Shuffling game with', this.state.currentGameMatch.registeredPlayers.length, 'players');
    
    try {
      const shuffledPlayers = await matchesApiService.shufflePlayers(
        this.state.currentGameMatch.id,
        this.state.currentGameMatch.registeredPlayers
      );
      
      const matches = await matchesApiService.createTournamentBracket(shuffledPlayers);
      console.log('Created', matches.length, 'matches');
      
      this.setState({
        shuffledMatches: matches
      });
    } catch (error) {
      console.error('Error shuffling game:', error);
      this.setState({
        error: error instanceof Error ? error.message : 'Failed to shuffle game'
      });
    }
  };

  private createTournamentBracket = (players: any[]): any[] => {
    const matches = [];
    for (let i = 0; i < players.length; i += 2) {
      if (i + 1 < players.length) {
        matches.push({
          id: Math.floor(i / 2) + 1,
          player1: players[i],
          player2: players[i + 1],
          status: 'pending',
          round: 1
        });
      }
    }
    return matches;
  };

  private handleCloseGameOrganization = (): void => {
    this.setState({
      showGameOrganization: false,
      currentGameMatch: null,
      shuffledMatches: []
    });
  };

  private generateRandomTime = (): string => {
    const hours = Math.floor(Math.random() * 12) + 13; // 13-24 (1 PM - 12 AM)
    const minutes = Math.floor(Math.random() * 60);
    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
  };

  private generateRandomDuration = (): string => {
    const minutes = Math.floor(Math.random() * 60) + 30; // 30-89 minutes
    return `${minutes} min`;
  };

  private generateRandomScore = (): string => {
    const score1 = Math.floor(Math.random() * 10) + 10; // 10-19
    const score2 = Math.floor(Math.random() * 10) + 5;  // 5-14
    return `${score1}-${score2}`;
  };

  private handleCloseProfileModal = (): void => {
    this.setState({
      showProfileModal: false,
      selectedProfile: null
    });
  };

  private handleCustomerPageChange = (page: number): void => {
    this.setState({
      customerPage: page
    });
  };

  private getPaginatedCustomers = (): any[] => {
    const { customerPage, customersPerPage } = this.state;
    const filteredCustomers = this.getFilteredCustomers();
    const startIndex = (customerPage - 1) * customersPerPage;
    const endIndex = startIndex + customersPerPage;
    return filteredCustomers.slice(startIndex, endIndex);
  };

  private getTotalPages = (): number => {
    const filteredCustomers = this.getFilteredCustomers();
    return Math.ceil(filteredCustomers.length / this.state.customersPerPage);
  };

  private getPageNumbers = (): (number | string)[] => {
    const currentPage = this.state.customerPage;
    const totalPages = this.getTotalPages();
    const pageNumbers: (number | string)[] = [];

    if (totalPages <= 7) {
      // Show all pages if 7 or fewer
      for (let i = 1; i <= totalPages; i++) {
        pageNumbers.push(i);
      }
    } else {
      // Always show first page
      pageNumbers.push(1);

      if (currentPage <= 4) {
        // Show first 5 pages, then ellipsis, then last page
        for (let i = 2; i <= 5; i++) {
          pageNumbers.push(i);
        }
        pageNumbers.push('...');
        pageNumbers.push(totalPages);
      } else if (currentPage >= totalPages - 3) {
        // Show first page, ellipsis, then last 5 pages
        pageNumbers.push('...');
        for (let i = totalPages - 4; i <= totalPages; i++) {
          pageNumbers.push(i);
        }
      } else {
        // Show first page, ellipsis, current-1, current, current+1, ellipsis, last page
        pageNumbers.push('...');
        pageNumbers.push(currentPage - 1);
        pageNumbers.push(currentPage);
        pageNumbers.push(currentPage + 1);
        pageNumbers.push('...');
        pageNumbers.push(totalPages);
      }
    }

    return pageNumbers;
  };

  private handleMatchClick = (match: Match): void => {
    this.setState({
      selectedMatch: match,
      showMatchDetails: true
    });
  };

  private handleEditMatch = (match: Match): void => {
    this.setState({
      isEditMode: true,
      isCreatingMatch: true,
      matchForm: {
        matchName: match.name,
        gameType: match.gameType,
        organizerName: match.organizerName || '',
        organizerDescription: match.organizerDescription || '',
        ballRules: match.ballRules,
        fewRules: '',
        matchDate: match.date,
        matchTime: match.time,
        registrationEndTime: '',
        venue: match.venue,
        locationId: match.location?.id || '',
        entryFee: match.entryFee.toString(),
        maxPlayers: match.maxPlayers.toString(),
        moreDetails: ''
      },
      selectedLocation: match.location || null
    });
  };

  private handleShowNotifiedUsers = (): void => {
    this.setState({ showNotifiedUsers: true });
  };

  private getStatusColor = (status: string): string => {
    switch(status) {
      case 'open': return 'bg-green-100 text-green-800 border-green-200';
      case 'scheduled': return 'bg-blue-100 text-blue-800 border-blue-200';
      case 'completed': return 'bg-gray-100 text-gray-800 border-gray-200';
      default: return 'bg-gray-100 text-gray-800 border-gray-200';
    }
  };

  // Notification methods
  private handleNotificationInputChange = (field: string, value: string | number[]): void => {
    this.setState({
      notificationForm: {
        ...this.state.notificationForm,
        [field]: value
      }
    });
  };

  private handleCustomerSelection = (customerId: number, isSelected: boolean): void => {
    const { selectedCustomers } = this.state.notificationForm;
    const updatedCustomers = isSelected
      ? [...selectedCustomers, customerId]
      : selectedCustomers.filter(id => id !== customerId);

    this.setState({
      notificationForm: {
        ...this.state.notificationForm,
        selectedCustomers: updatedCustomers
      }
    });
  };

  private handleSelectAllCustomers = (): void => {
    const allCustomerIds = this.registeredCustomers.map(customer => customer.id);
    this.setState({
      notificationForm: {
        ...this.state.notificationForm,
        selectedCustomers: allCustomerIds
      }
    });
  };

  private handleClearCustomerSelection = (): void => {
    this.setState({
      notificationForm: {
        ...this.state.notificationForm,
        selectedCustomers: []
      }
    });
  };

  private handleSendNotification = (): void => {
    const { notificationForm } = this.state;
    const { notificationType, selectedCustomers } = notificationForm;
    
    let sentTo = '';
    let sentCount = 0;

    if (notificationType === 'all') {
      sentTo = 'All Customers';
      sentCount = this.registeredCustomers.length;
    } else {
      sentTo = 'Selected Customers';
      sentCount = selectedCustomers.length;
    }

    console.log('Notification sent:', {
      ...notificationForm,
      sentTo,
      sentCount,
      sentAt: new Date().toISOString()
    });

    // Reset form and close modal
    this.setState({
      showSendNotificationModal: false,
      notificationForm: {
        title: '',
        message: '',
        notificationType: 'all',
        selectedCustomers: []
      }
    });

    alert(`Notification sent successfully to ${sentCount} customers!`);
  };

  private handleOpenSendNotification = (matchId?: number): void => {
    this.setState({
      showSendNotificationModal: true,
      notificationForm: {
        ...this.state.notificationForm,
        matchId
      }
    });
  };

  render() {
    // Show loading state
    if (this.state.loading) {
      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 w-full flex items-center justify-center">
          <div className="text-center">
            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
            <p className="text-gray-600">Loading matches...</p>
          </div>
        </div>
      );
    }

    // Show error state
    if (this.state.error) {
      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 w-full flex items-center justify-center">
          <div className="text-center">
            <div className="text-red-500 text-6xl mb-4"></div>
            <h2 className="text-xl font-semibold text-gray-900 mb-2">Error Loading Data</h2>
            <p className="text-gray-600 mb-4">{this.state.error}</p>
            <button
              onClick={() => this.loadData()}
              className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
            >
              Retry
            </button>
          </div>
        </div>
      );
    }

    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 w-full">
        {/* Header */}
        <div className="bg-white shadow-lg border-b border-gray-200">
          <div className="max-w-7xl mx-auto px-6 py-4">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-3">
                <div className="w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center">
                  <Trophy className="w-6 h-6 text-white" />
                </div>
                <div>
                  <h1 className="text-2xl font-bold text-gray-900">Organizer Portal</h1>
                  <p className="text-sm text-gray-600">Billiards Tournament Management</p>
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="text-right">
                  <div className="text-sm font-medium text-gray-900">John Organizer</div>
                  <div className="text-xs text-gray-500">Tournament Director</div>
                </div>
                <div className="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">
                  <User className="w-4 h-4 text-gray-600" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div className="max-w-7xl mx-auto px-6 py-8">
          {/* Navigation Tabs */}
          <div className="mb-8">
            <div className="flex space-x-1 bg-gray-100 rounded-lg p-1">
              <button
                onClick={() => this.setState({ activeTab: 'schedule' })}
                className={`px-6 py-3 rounded-md text-sm font-medium transition-colors ${
                  this.state.activeTab === 'schedule'
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                Schedule Match
              </button>
              <button
                onClick={() => this.setState({ activeTab: 'scheduled' })}
                className={`px-6 py-3 rounded-md text-sm font-medium transition-colors ${
                  this.state.activeTab === 'scheduled'
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                Scheduled Matches
              </button>
              <button
                onClick={() => this.setState({ activeTab: 'previous' })}
                className={`px-6 py-3 rounded-md text-sm font-medium transition-colors ${
                  this.state.activeTab === 'previous'
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                Previous Matches
              </button>
              <button
                onClick={() => this.setState({ activeTab: 'notifications' })}
                className={`px-6 py-3 rounded-md text-sm font-medium transition-colors ${
                  this.state.activeTab === 'notifications'
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                Notifications
              </button>
              <button
                onClick={() => this.setState({ activeTab: 'settings' })}
                className={`px-6 py-3 rounded-md text-sm font-medium transition-colors ${
                  this.state.activeTab === 'settings'
                    ? 'bg-white text-blue-600 shadow-sm'
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                Settings
              </button>
            </div>
          </div>

          {/* Progress Indicator for Game Organization */}
          {this.state.activeTab === 'scheduled' && (
            <div className="mb-8">
              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <div className={`flex items-center gap-2 px-4 py-2 rounded-lg ${
                      !this.state.showGameOrganization 
                        ? 'bg-blue-100 text-blue-800' 
                        : 'bg-gray-100 text-gray-600'
                    }`}>
                      <div className={`w-3 h-3 rounded-full ${
                        !this.state.showGameOrganization ? 'bg-blue-500' : 'bg-gray-400'
                      }`}></div>
                      <span className="font-medium">Step 1: Scheduled Matches</span>
                    </div>
                    <div className="flex-1 h-px bg-gray-200"></div>
                    <div className={`flex items-center gap-2 px-4 py-2 rounded-lg ${
                      this.state.showGameOrganization 
                        ? 'bg-blue-100 text-blue-800' 
                        : 'bg-gray-100 text-gray-600'
                    }`}>
                      <div className={`w-3 h-3 rounded-full ${
                        this.state.showGameOrganization ? 'bg-blue-500' : 'bg-gray-400'
                      }`}></div>
                      <span className="font-medium">Step 2: Game Organization</span>
                    </div>
                  </div>
                  {this.state.showGameOrganization && this.state.currentGameMatch && (
                    <div className="text-right">
                      <div className="text-sm text-gray-600">Current Match</div>
                      <div className="font-semibold text-gray-900">{this.state.currentGameMatch.name}</div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Schedule Match Tab */}
          {this.state.activeTab === 'schedule' && (
            <div className="space-y-6">
              {!this.state.isCreatingMatch ? (
                <div className="bg-white rounded-2xl shadow-lg p-8 border border-gray-100">
                  <div className="text-center">
                    <div className="w-16 h-16 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                      <Plus className="w-8 h-8 text-blue-600" />
                    </div>
                    <h2 className="text-2xl font-bold text-gray-900 mb-2">Create New Match</h2>
                    <p className="text-gray-600 mb-6">Schedule a new billiards tournament with custom rules and settings</p>
                    <button
                      onClick={() => this.setState({ isCreatingMatch: true })}
                      className="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center gap-2 mx-auto"
                    >
                      <Plus className="w-5 h-5" />
                      Schedule New Match
                    </button>
                  </div>
                </div>
              ) : (
                <div className="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                  <div className="bg-gradient-to-r from-blue-600 to-purple-600 px-8 py-6">
                    <div className="flex items-center justify-between">
                      <div>
                        <h2 className="text-2xl font-bold text-white">
                          {this.state.isEditMode ? 'Edit Match Setup' : 'New Match Setup'}
                        </h2>
                        <p className="text-blue-100 mt-1">
                          {this.state.isEditMode ? 'Update your tournament details' : 'Configure your tournament details'}
                        </p>
                      </div>
                      <button
                        type="button"
                        onClick={() => {
                          this.setState({
                            isCreatingMatch: false,
                            isEditMode: false
                          });
                        }}
                        className="text-white hover:text-blue-200 transition-colors"
                      >
                        <X className="w-6 h-6" />
                      </button>
                    </div>
                  </div>

                  <div className="p-8 space-y-8">
                    {/* Basic Information */}
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <Settings className="w-5 h-5 text-blue-600" />
                        Basic Information
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Match Name *
                          </label>
                          <input
                            type="text"
                            required
                            value={this.state.matchForm.matchName}
                            onChange={(e) => this.handleInputChange('matchName', e.target.value)}
                            placeholder="e.g., 9-Ball Championship 2025"
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Location *
                          </label>
                          <select
                            value={this.state.matchForm.locationId}
                            onChange={(e) => this.handleInputChange('locationId', e.target.value)}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          >
                            <option value="">Select Location</option>
                            {this.organizationLocations.map(location => (
                              <option key={location.id} value={location.id}>
                                {location.name}
                              </option>
                            ))}
                          </select>
                        </div>
                      </div>

                      {/* Location Details */}
                      {this.state.selectedLocation && (
                        <div className="mt-6 bg-gray-50 p-4 rounded-lg">
                          <h4 className="font-medium text-gray-900 mb-2">Location Details</h4>
                          <div className="space-y-2 text-sm">
                            <p><span className="font-medium">Address:</span> {this.state.selectedLocation.address}</p>
                            <p><span className="font-medium">Phone:</span> {this.state.selectedLocation.phone}</p>
                            <div>
                              <span className="font-medium">Facilities:</span>
                              <div className="flex flex-wrap gap-1 mt-1">
                                {this.state.selectedLocation.facilities.map((facility, index) => (
                                  <span key={index} className="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">
                                    {facility}
                                  </span>
                                ))}
                              </div>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>

                    {/* Game Configuration */}
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <Target className="w-5 h-5 text-green-600" />
                        Game Configuration
                      </h3>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Game Type *
                          </label>
                          <select
                            value={this.state.matchForm.gameType}
                            onChange={(e) => this.handleInputChange('gameType', e.target.value)}
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          >
                            {this.gameTypes.map(type => (
                              <option key={type.value} value={type.value}>
                                {type.label}
                              </option>
                            ))}
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Game Organizer Name *
                          </label>
                          <input
                            type="text"
                            required
                            value={this.state.matchForm.organizerName}
                            onChange={(e) => this.handleInputChange('organizerName', e.target.value)}
                            placeholder="e.g., John Tournament Director"
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          />
                        </div>
                      </div>

                      <div className="mt-6">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Organizer Description
                        </label>
                        <textarea
                          value={this.state.matchForm.organizerDescription}
                          onChange={(e) => this.handleInputChange('organizerDescription', e.target.value)}
                          placeholder="Brief description about the organizer's experience and credentials..."
                          rows={2}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                      </div>

                      {/* Ball Rules */}
                      <div className="mt-6">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Ball Rules
                        </label>
                        <select
                          value={this.state.matchForm.ballRules}
                          onChange={(e) => this.handleInputChange('ballRules', e.target.value)}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                          {this.ballRulesOptions.map(option => (
                            <option key={option.value} value={option.value}>
                              {option.label}
                            </option>
                          ))}
                        </select>
                      </div>

                      {/* Few Rules */}
                      <div className="mt-6">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Few Rules...
                        </label>
                        <textarea
                          value={this.state.matchForm.fewRules}
                          onChange={(e) => this.handleInputChange('fewRules', e.target.value)}
                          placeholder="Add specific rules for this tournament..."
                          rows={3}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        />
                      </div>
                    </div>

                    {/* More Details */}
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        More Details...
                      </label>
                      <textarea
                        value={this.state.matchForm.moreDetails}
                        onChange={(e) => this.handleInputChange('moreDetails', e.target.value)}
                        placeholder="Add any additional details, venue information, or notes for players..."
                        rows={4}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                      />
                    </div>

                    {/* Notification Section */}
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                        <AlertCircle className="w-5 h-5 text-purple-600" />
                        Send Notification
                      </h3>
                      <div className="bg-purple-50 p-6 rounded-lg border border-purple-200">
                        <div className="space-y-4">
                          <div className="flex items-center">
                            <input
                              type="checkbox"
                              id="sendNotification"
                              checked={this.state.matchForm.sendNotification || false}
                              onChange={(e) => this.handleInputChange('sendNotification', e.target.checked)}
                              className="w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 focus:ring-2"
                            />
                            <label htmlFor="sendNotification" className="ml-3 text-sm font-medium text-gray-700">
                              Send notification to customers about this tournament
                            </label>
                          </div>

                          {this.state.matchForm.sendNotification && (
                            <div className="space-y-4 mt-4">
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Notification Title
                                  </label>
                                  <div className="flex gap-2">
                                    <input
                                      type="text"
                                      value={this.state.matchForm.notificationTitle || ''}
                                      onChange={(e) => this.handleInputChange('notificationTitle', e.target.value)}
                                      placeholder={this.state.matchForm.matchName ? `New Tournament: ${this.state.matchForm.matchName}` : "e.g., New Tournament: 9-Ball Championship"}
                                      className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    />
                                    {this.state.matchForm.matchName && !this.state.matchForm.notificationTitle && (
                                      <button
                                        type="button"
                                        onClick={() => this.handleInputChange('notificationTitle', `New Tournament: ${this.state.matchForm.matchName}`)}
                                        className="px-3 py-3 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm font-medium"
                                        title="Auto-fill with match name"
                                      >
                                        Auto-fill
                                      </button>
                                    )}
                                  </div>
                                </div>
                                <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Recipients
                                  </label>
                                  <select
                                    value={this.state.matchForm.notificationRecipients || 'all'}
                                    onChange={(e) => this.handleInputChange('notificationRecipients', e.target.value)}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                  >
                                    <option value="all">All Registered Customers</option>
                                    <option value="advanced">Advanced Players Only</option>
                                    <option value="intermediate">Intermediate Players Only</option>
                                    <option value="beginner">Beginner Players Only</option>
                                  </select>
                                </div>
                              </div>

                              <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                  Notification Message
                                </label>
                                <textarea
                                  value={this.state.matchForm.notificationMessage || ''}
                                  onChange={(e) => this.handleInputChange('notificationMessage', e.target.value)}
                                  placeholder="Enter your notification message..."
                                  rows={3}
                                  className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                              </div>

                              {/* Customer Selection for Specific Skill Levels */}
                              {this.state.matchForm.notificationRecipients && this.state.matchForm.notificationRecipients !== 'all' && (
                                <div>
                                  <h4 className="font-medium text-gray-900 mb-3">Select Customers</h4>
                                  <div className="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                    <div className="flex items-center justify-between mb-4">
                                      <span className="text-sm text-gray-600">
                                        {this.state.matchForm.notificationRecipients === 'advanced' ? 'Advanced Players' :
                                         this.state.matchForm.notificationRecipients === 'intermediate' ? 'Intermediate Players' :
                                         this.state.matchForm.notificationRecipients === 'beginner' ? 'Beginner Players' :
                                         'Selected Customers'}
                                      </span>
                                      <div className="flex gap-2">
                                        <button
                                          type="button"
                                          onClick={() => this.handleSelectAllSkillCustomers()}
                                          className="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded hover:bg-blue-200 transition-colors"
                                        >
                                          Select Page
                                        </button>
                                        <button
                                          type="button"
                                          onClick={() => this.handleClearSkillCustomerSelection()}
                                          className="px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded hover:bg-gray-200 transition-colors"
                                        >
                                          Clear Page
                                        </button>
                                      </div>
                                    </div>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-48 overflow-y-auto">
                                      {this.getPaginatedCustomers().map((customer) => (
                                        <div key={customer.id} className="flex items-center p-3 bg-white rounded border hover:bg-gray-50 transition-colors">
                                          <input
                                            type="checkbox"
                                            id={`skill-customer-${customer.id}`}
                                            checked={this.state.matchForm.selectedSkillCustomers?.includes(customer.id) || false}
                                            onChange={(e) => this.handleSkillCustomerSelection(customer.id, e.target.checked)}
                                            className="w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 focus:ring-2"
                                          />
                            <label htmlFor={`skill-customer-${customer.id}`} className="ml-3 flex-1 cursor-pointer">
                              <div className="flex items-center gap-2">
                                <img 
                                  src={customer.profilePic || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face'} 
                                  alt={customer.name}
                                  className="w-8 h-8 rounded-full object-cover border-2 border-gray-200"
                                />
                                <div>
                                  <div className="font-medium text-gray-900 text-sm">{customer.name}</div>
                                  <div className="text-xs text-gray-600">{customer.email}</div>
                                  <span className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">
                                    {customer.skill}
                                  </span>
                                </div>
                              </div>
                            </label>
                                        </div>
                                      ))}
                                    </div>
                                    
                                    {/* Pagination Controls */}
                                    {this.getTotalPages() > 1 && (
                                      <div className="mt-4 flex items-center justify-between">
                                        <div className="text-sm text-gray-600">
                                          Page {this.state.customerPage} of {this.getTotalPages()}
                                        </div>
                                        <div className="flex items-center gap-2">
                                          <button
                                            type="button"
                                            onClick={() => this.handleCustomerPageChange(this.state.customerPage - 1)}
                                            disabled={this.state.customerPage === 1}
                                            className="px-4 py-2 text-sm font-semibold bg-white text-gray-700 border-2 border-gray-200 rounded-lg shadow-sm hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-200 disabled:hover:text-gray-700 disabled:hover:shadow-sm disabled:hover:scale-100 transition-all duration-200"
                                          >
                                            Previous
                                          </button>
                                          
                                          {/* Page Numbers */}
                                          {this.getPageNumbers().map((pageNum, index) => (
                                            <React.Fragment key={index}>
                                              {pageNum === '...' ? (
                                                <span className="px-2 py-1 text-sm text-gray-500">...</span>
                                              ) : (
                                                <button
                                                  type="button"
                                                  onClick={() => this.handleCustomerPageChange(pageNum as number)}
                                                  className={`px-4 py-2 text-sm font-semibold rounded-lg border-2 transition-all duration-200 shadow-sm ${
                                                    this.state.customerPage === pageNum
                                                      ? 'bg-purple-600 text-white border-purple-600 shadow-lg transform scale-105'
                                                      : 'bg-white text-gray-700 border-gray-200 hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105'
                                                  }`}
                                                >
                                                  {pageNum}
                                                </button>
                                              )}
                                            </React.Fragment>
                                          ))}
                                          
                                          <button
                                            type="button"
                                            onClick={() => this.handleCustomerPageChange(this.state.customerPage + 1)}
                                            disabled={this.state.customerPage === this.getTotalPages()}
                                            className="px-4 py-2 text-sm font-semibold bg-white text-gray-700 border-2 border-gray-200 rounded-lg shadow-sm hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-200 disabled:hover:text-gray-700 disabled:hover:shadow-sm disabled:hover:scale-100 transition-all duration-200"
                                          >
                                            Next
                                          </button>
                                        </div>
                                      </div>
                                    )}
                                    
                                    <div className="mt-3 text-sm text-gray-600">
                                      Selected: {this.state.matchForm.selectedSkillCustomers?.length || 0} of {this.getFilteredCustomers().length} customers
                                    </div>
                                  </div>
                                </div>
                              )}

                              {/* Notification Preview */}
                              <div className="bg-white p-4 rounded-lg border border-purple-200">
                                <h4 className="font-medium text-purple-900 mb-2">Notification Preview</h4>
                                <div className="space-y-2 text-sm">
                                  <p><span className="font-medium">Title:</span> {this.state.matchForm.notificationTitle || 'New Tournament Available'}</p>
                                  <p><span className="font-medium">Message:</span> {this.state.matchForm.notificationMessage || 'A new tournament has been scheduled!'}</p>
                                  <p><span className="font-medium">Recipients:</span> {
                                    this.state.matchForm.notificationRecipients === 'all' ? 'All Registered Customers' :
                                    this.state.matchForm.notificationRecipients === 'advanced' ? 'Selected Advanced Players' :
                                    this.state.matchForm.notificationRecipients === 'intermediate' ? 'Selected Intermediate Players' :
                                    this.state.matchForm.notificationRecipients === 'beginner' ? 'Selected Beginner Players' :
                                    'All Registered Customers'
                                  }</p>
                                  <p><span className="font-medium">Recipients Count:</span> {
                                    this.state.matchForm.notificationRecipients === 'all' ? this.registeredCustomers.length :
                                    this.state.matchForm.selectedSkillCustomers?.length || 0
                                  } customers</p>
                                </div>
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Submit Actions */}
                    <div className="bg-gray-50 px-8 py-6 border-t border-gray-200 -mx-8">
                      <div className="flex justify-end gap-4">
                        <button
                          type="button"
                          onClick={() => {
                            this.setState({
                              isCreatingMatch: false,
                              isEditMode: false
                            });
                          }}
                          className="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                        >
                          Cancel
                        </button>
                        <button
                          type="button"
                          onClick={this.handleSubmit}
                          className="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 flex items-center gap-2"
                        >
                          <Save className="w-5 h-5" />
                          {this.state.isEditMode ? 'Update Match' : 'Schedule Match'}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          )}

          {/* Scheduled Matches Tab */}
          {this.state.activeTab === 'scheduled' && !this.state.showGameOrganization && (
            <div className="space-y-6">
              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-xl font-bold text-gray-900">Scheduled Matches</h2>
                  <div className="flex items-center gap-2 text-sm text-gray-600">
                    <span className="w-2 h-2 bg-blue-500 rounded-full"></span>
                    Step 1 of 2
                  </div>
                </div>
                <div className="space-y-4">
                  {this.state.scheduledMatches.map((match) => (
                    <div key={match.id} className="border border-gray-200 rounded-lg p-6 hover:bg-gray-50 transition-colors">
                      <div className="flex items-start justify-between mb-4">
                        <div className="flex-1 cursor-pointer" onClick={() => this.handleMatchClick(match)}>
                          <div className="flex items-center gap-3 mb-2">
                            <h3 className="text-lg font-semibold text-gray-900">{match.name}</h3>
                            <span className={`px-3 py-1 text-sm font-medium rounded-full border ${this.getStatusColor(match.status)}`}>
                              {match.status.charAt(0).toUpperCase() + match.status.slice(1)}
                            </span>
                          </div>
                          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600">
                            <div className="flex items-center gap-2">
                              <Target className="w-4 h-4" />
                              {match.gameType}
                            </div>
                            <div className="flex items-center gap-2">
                              <Calendar className="w-4 h-4" />
                              {new Date(match.date).toLocaleDateString()}
                            </div>
                            <div className="flex items-center gap-2">
                              <Clock className="w-4 h-4" />
                              {match.time}
                            </div>
                            <div className="flex items-center gap-2">
                              <Users className="w-4 h-4" />
                              {match.players}/{match.maxPlayers} players
                            </div>
                          </div>
                        </div>
                        <div className="text-right">
                          <div className="text-lg font-bold text-green-600">${match.entryFee}</div>
                          <div className="text-sm text-gray-500">Entry Fee</div>
                        </div>
                      </div>

                      {/* Action Buttons */}
                      <div className="flex flex-wrap gap-2 mb-4">
                        <button
                          onClick={() => this.handleEditMatch(match)}
                          className="px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"
                        >
                          <Settings className="w-4 h-4" />
                          Edit Match
                        </button>
                        <button
                          onClick={() => this.handleOpenSendNotification(match.id)}
                          className="px-4 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2"
                        >
                          <AlertCircle className="w-4 h-4" />
                          Send Notification
                        </button>
                        <button
                          onClick={this.handleShowNotifiedUsers}
                          className="px-4 py-2 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2"
                        >
                          <AlertCircle className="w-4 h-4" />
                          Notified Users ({match.notifiedUsers?.count || 0})
                        </button>
                      </div>

                      {/* Registered Players */}
                      {match.registeredPlayers && match.registeredPlayers.length > 0 && (
                        <div className="bg-gray-50 p-4 rounded-lg">
                          <h4 className="font-medium text-gray-900 mb-3">
                            Registered Players ({match.registeredPlayers.length})
                          </h4>
                          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                            {match.registeredPlayers.map((player) => (
                              <div 
                                key={player.id} 
                                className="bg-white p-3 rounded border hover:shadow-md transition-shadow cursor-pointer hover:border-blue-300"
                                onClick={() => this.handleOpenProfileModal(player)}
                              >
                                <div className="flex items-center gap-3 mb-2">
                                  <div className="relative">
                                    <img
                                      src={player.profilePic}
                                      alt={player.name}
                                      className="w-10 h-10 rounded-full object-cover border-2 border-blue-400"
                                    />
                                    <div className="absolute -bottom-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
                                      {player.id}
                                    </div>
                                  </div>
                                  <div className="flex-1">
                                    <div className="font-medium text-gray-900">{player.name}</div>
                                    <div className="text-sm text-gray-600">{player.email}</div>
                                  </div>
                                </div>
                                <div className="flex justify-between items-center mt-1">
                                  <span className={`text-xs px-2 py-1 rounded ${
                                    player.skill === 'Pro' ? 'bg-purple-100 text-purple-800' :
                                    player.skill === 'Expert' ? 'bg-red-100 text-red-800' :
                                    player.skill === 'Advanced' ? 'bg-blue-100 text-blue-800' :
                                    'bg-green-100 text-green-800'
                                  }`}>
                                    {player.skill}
                                  </span>
                                  <span className="text-xs text-gray-500">
                                    {new Date(player.registeredAt).toLocaleDateString()}
                                  </span>
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                      
                      {/* Game Initiate Button */}
                      <div className="mt-6 flex justify-center">
                        <button
                          onClick={() => this.handleGameInitiate(match)}
                          className="bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 flex items-center gap-3"
                        >
                          <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-5-8a3 3 0 11-6 0 3 3 0 016 0z" />
                          </svg>
                          Next: Game Organization
                          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                          </svg>
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          )}

          {/* Game Organization Section */}
          {this.state.showGameOrganization && this.state.currentGameMatch && (
            <div className="space-y-6">
              {/* Navigation Header */}
              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <div className="flex items-center justify-between mb-6">
                  <div className="flex items-center gap-4">
                    <button
                      onClick={this.handleCloseGameOrganization}
                      className="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg"
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                      </svg>
                      Previous: Scheduled Matches
                    </button>
                    <div className="h-6 w-px bg-gray-300"></div>
                    <h2 className="text-xl font-bold text-gray-900">Game Organization - {this.state.currentGameMatch.name}</h2>
                  </div>
                  <div className="flex items-center gap-3">
                    <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                      {this.state.currentGameMatch.players}/{this.state.currentGameMatch.maxPlayers} Players
                    </span>
                    <div className="flex items-center gap-2 text-sm text-gray-600">
                      <span className="w-2 h-2 bg-blue-500 rounded-full"></span>
                      Step 2 of 2
                    </div>
                  </div>
                </div>
              </div>

              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">

                {/* Tournament Info */}
                <div className="bg-gray-50 p-4 rounded-lg mb-6">
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600">
                    <div className="flex items-center gap-2">
                      <Target className="w-4 h-4" />
                      {this.state.currentGameMatch.gameType}
                    </div>
                    <div className="flex items-center gap-2">
                      <Calendar className="w-4 h-4" />
                      {new Date(this.state.currentGameMatch.date).toLocaleDateString()}
                    </div>
                    <div className="flex items-center gap-2">
                      <Clock className="w-4 h-4" />
                      {this.state.currentGameMatch.time}
                    </div>
                    <div className="flex items-center gap-2">
                      <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                      </svg>
                      {this.state.currentGameMatch.venue}
                    </div>
                  </div>
                </div>

                {/* Players List - Only show when no matches are shuffled */}
                {this.state.shuffledMatches.length === 0 && (
                  <div className="mb-6">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="text-lg font-semibold text-gray-900">Registered Players ({this.state.currentGameMatch.registeredPlayers?.length || 0})</h3>
                      <button
                        onClick={this.handleShuffleGame}
                        className="bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 flex items-center gap-2"
                      >
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        Shuffle Game
                      </button>
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                      {this.state.currentGameMatch.registeredPlayers?.map((player) => (
                        <div key={player.id} className="bg-gray-50 p-4 rounded-lg border border-gray-200">
                          <div className="flex items-center gap-3 mb-2">
                            <div className="relative">
                              <img
                                src={player.profilePic}
                                alt={player.name}
                                className="w-10 h-10 rounded-full object-cover border-2 border-blue-400"
                              />
                              <div className="absolute -bottom-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
                                {player.id}
                              </div>
                            </div>
                            <div className="flex-1">
                              <div className="font-medium text-gray-900">{player.name}</div>
                              <div className="text-sm text-gray-600">{player.email}</div>
                            </div>
                          </div>
                          <div className="flex justify-between items-center">
                            <span className={`text-xs px-2 py-1 rounded ${
                              player.skill === 'Pro' ? 'bg-purple-100 text-purple-800' :
                              player.skill === 'Expert' ? 'bg-red-100 text-red-800' :
                              player.skill === 'Advanced' ? 'bg-blue-100 text-blue-800' :
                              'bg-green-100 text-green-800'
                            }`}>
                              {player.skill}
                            </span>
                            <span className="text-xs text-gray-500">
                              {new Date(player.registeredAt).toLocaleDateString()}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Shuffle Button - Show when matches are shuffled */}
                {this.state.shuffledMatches.length > 0 && (
                  <div className="mb-6 flex justify-center">
                    <button
                      onClick={this.handleShuffleGame}
                      className="bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 flex items-center gap-2"
                    >
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                      </svg>
                      Shuffle Again
                    </button>
                  </div>
                )}


                {/* Tournament Bracket */}
                {this.state.shuffledMatches.length > 0 ? (
                  <div className="bg-gray-50 p-6 rounded-lg">
                    <div className="flex items-center justify-between mb-6">
                      <h3 className="text-lg font-semibold text-gray-900">Tournament Bracket - Round 1 (First Round)</h3>
                      <div className="flex items-center gap-4">
                        <span className="text-sm text-gray-600">
                          Round 1 (First Round): {this.state.shuffledMatches.length * 2} players  {this.state.shuffledMatches.length} matches  {this.state.shuffledMatches.length} winners
                        </span>
                      </div>
                    </div>

                    <div className="space-y-4">
                      {this.state.shuffledMatches.map((match) => (
                        <div key={match.id} className="bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
                          <div className="flex items-center justify-between mb-4">
                            <h4 className="font-semibold text-gray-900">Match #{match.id}</h4>
                            <span className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium flex items-center gap-1">
                              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                              </svg>
                              COMPLETED
                            </span>
                          </div>
                          
                          <div className="flex items-center justify-between mb-4">
                            {/* Player 1 */}
                            <div className="flex items-center gap-3 flex-1 bg-green-50 p-4 rounded-lg border border-green-200">
                              <div className="relative">
                                <img
                                  src={match.player1.profilePic}
                                  alt={match.player1.name}
                                  className="w-16 h-16 rounded-full object-cover border-2 border-green-400"
                                />
                                <div className="absolute -top-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">
                                  Winner
                                </div>
                              </div>
                              <div>
                                <div className="font-semibold text-gray-900 text-lg">{match.player1.name}</div>
                                <div className="text-sm text-gray-600">Rank #{match.player1.rank}  Rating: {match.player1.rating}</div>
                              </div>
                            </div>

                            {/* VS */}
                            <div className="flex items-center justify-center mx-6">
                              <div className="w-16 h-16 bg-gray-300 rounded-full flex items-center justify-center">
                                <span className="text-gray-600 font-bold text-lg">VS</span>
                              </div>
                            </div>

                            {/* Player 2 */}
                            <div className="flex items-center gap-3 flex-1 bg-white p-4 rounded-lg border border-gray-200">
                              <div className="relative">
                                <img
                                  src={match.player2.profilePic}
                                  alt={match.player2.name}
                                  className="w-16 h-16 rounded-full object-cover border-2 border-gray-300"
                                />
                              </div>
                              <div>
                                <div className="font-semibold text-gray-900 text-lg">{match.player2.name}</div>
                                <div className="text-sm text-gray-600">Rank #{match.player2.rank}  Rating: {match.player2.rating}</div>
                              </div>
                            </div>
                          </div>

                          {/* Match Statistics */}
                          <div className="bg-gray-50 p-4 rounded-lg">
                            <div className="grid grid-cols-5 gap-4 text-center">
                              <div>
                                <div className="text-sm font-semibold text-gray-900 mb-1">STATUS</div>
                                <div className="flex items-center justify-center gap-1 text-green-600">
                                  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                  </svg>
                                  <span className="text-sm font-medium">COMPLETED</span>
                                </div>
                              </div>
                              <div>
                                <div className="text-sm font-semibold text-gray-900 mb-1">START TIME</div>
                                <div className="text-sm text-gray-600">{this.generateRandomTime()}</div>
                                <div className="text-xs text-gray-500">Started</div>
                              </div>
                              <div>
                                <div className="text-sm font-semibold text-gray-900 mb-1">END TIME</div>
                                <div className="text-sm text-gray-600">{this.generateRandomTime()}</div>
                                <div className="text-xs text-gray-500">Finished</div>
                              </div>
                              <div>
                                <div className="text-sm font-semibold text-gray-900 mb-1">DURATION</div>
                                <div className="text-sm text-gray-600">{this.generateRandomDuration()}</div>
                                <div className="text-xs text-gray-500">Total Time</div>
                              </div>
                              <div>
                                <div className="text-sm font-semibold text-gray-900 mb-1">SCORE</div>
                                <div className="text-sm font-semibold text-blue-600">Final: {this.generateRandomScore()}</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                ) : (
                  <div className="bg-gray-50 p-6 rounded-lg text-center">
                    <div className="text-gray-500 mb-4">
                      <svg className="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                      <h3 className="text-lg font-semibold text-gray-700 mb-2">No Tournament Bracket Yet</h3>
                      <p className="text-gray-600">Click "Shuffle Game" to create the tournament bracket with randomized match pairings.</p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Previous Matches Tab */}
          {this.state.activeTab === 'previous' && (
            <div className="space-y-6">
              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-xl font-bold text-gray-900">Previous Matches</h2>
                  <div className="text-sm text-gray-600">
                    Showing {((this.state.previousMatchesPage - 1) * this.state.previousMatchesPerPage) + 1}-{Math.min(this.state.previousMatchesPage * this.state.previousMatchesPerPage, this.state.previousMatches.length)} of {this.state.previousMatches.length} matches
                  </div>
                </div>
                <div className="space-y-4">
                  {this.getPaginatedPreviousMatches().map((match) => (
                    <div key={match.id} className="border border-gray-200 rounded-lg p-6 hover:bg-gray-50 transition-colors cursor-pointer" onClick={() => this.handleShowMatchDetailsModal(match)}>
                      <div className="flex items-start justify-between mb-4">
                        <div className="flex-1">
                          <div className="flex items-center gap-3 mb-2">
                            <h3 className="text-lg font-semibold text-gray-900">{match.name}</h3>
                            <span className={`px-3 py-1 text-sm font-medium rounded-full border ${this.getStatusColor(match.status)}`}>
                              {match.status.charAt(0).toUpperCase() + match.status.slice(1)}
                            </span>
                          </div>
                          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600">
                            <div className="flex items-center gap-2">
                              <Target className="w-4 h-4" />
                              {match.gameType}
                            </div>
                            <div className="flex items-center gap-2">
                              <Calendar className="w-4 h-4" />
                              {new Date(match.date).toLocaleDateString()}
                            </div>
                            <div className="flex items-center gap-2">
                              <Clock className="w-4 h-4" />
                              {match.time}
                            </div>
                            <div className="flex items-center gap-2">
                              <Users className="w-4 h-4" />
                              {match.players} players
                            </div>
                          </div>
                        </div>
                        <div className="text-right">
                          <div className="text-lg font-bold text-gray-600">${match.entryFee}</div>
                          <div className="text-sm text-gray-500">Entry Fee</div>
                        </div>
                      </div>

                    </div>
                  ))}
                </div>
                
                {/* Pagination Controls for Previous Matches */}
                {this.getPreviousMatchesTotalPages() > 1 && (
                  <div className="mt-6 flex items-center justify-between">
                    <div className="text-sm text-gray-600">
                      Page {this.state.previousMatchesPage} of {this.getPreviousMatchesTotalPages()}
                    </div>
                    <div className="flex items-center gap-2">
                      <button
                        onClick={() => this.handlePreviousMatchesPageChange(this.state.previousMatchesPage - 1)}
                        disabled={this.state.previousMatchesPage === 1}
                        className="px-4 py-2 text-sm font-semibold bg-white text-gray-700 border-2 border-gray-200 rounded-lg shadow-sm hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-200 disabled:hover:text-gray-700 disabled:hover:shadow-sm disabled:hover:scale-100 transition-all duration-200"
                      >
                        Previous
                      </button>
                      
                      {/* Page Numbers */}
                      {this.getPreviousMatchesPageNumbers().map((pageNum, index) => (
                        <React.Fragment key={index}>
                          {pageNum === '...' ? (
                            <span className="px-2 py-1 text-sm text-gray-500">...</span>
                          ) : (
                            <button
                              onClick={() => this.handlePreviousMatchesPageChange(pageNum as number)}
                              className={`px-4 py-2 text-sm font-semibold rounded-lg border-2 transition-all duration-200 shadow-sm ${
                                this.state.previousMatchesPage === pageNum
                                  ? 'bg-purple-600 text-white border-purple-600 shadow-lg transform scale-105'
                                  : 'bg-white text-gray-700 border-gray-200 hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105'
                              }`}
                            >
                              {pageNum}
                            </button>
                          )}
                        </React.Fragment>
                      ))}
                      
                      <button
                        onClick={() => this.handlePreviousMatchesPageChange(this.state.previousMatchesPage + 1)}
                        disabled={this.state.previousMatchesPage === this.getPreviousMatchesTotalPages()}
                        className="px-4 py-2 text-sm font-semibold bg-white text-gray-700 border-2 border-gray-200 rounded-lg shadow-sm hover:bg-purple-50 hover:border-purple-400 hover:text-purple-800 hover:shadow-md hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-white disabled:hover:border-gray-200 disabled:hover:text-gray-700 disabled:hover:shadow-sm disabled:hover:scale-100 transition-all duration-200"
                      >
                        Next
                      </button>
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Notifications Tab */}
          {this.state.activeTab === 'notifications' && (
            <div className="space-y-6">
              <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-xl font-bold text-gray-900">Notification Management</h2>
                  <button
                    onClick={() => this.handleOpenSendNotification()}
                    className="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-3 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all duration-200 flex items-center gap-2"
                  >
                    <Plus className="w-5 h-5" />
                    Send New Notification
                  </button>
                </div>

                {/* Notification History */}
                <div className="space-y-4">
                  <h3 className="text-lg font-semibold text-gray-900 mb-4">Notification History</h3>
                  {this.notificationHistory.map((notification) => (
                    <div key={notification.id} className="border border-gray-200 rounded-lg p-6 hover:bg-gray-50 transition-colors">
                      <div className="flex items-start justify-between mb-3">
                        <div className="flex-1">
                          <div className="flex items-center gap-3 mb-2">
                            <h4 className="text-lg font-semibold text-gray-900">{notification.title}</h4>
                            <span className={`px-3 py-1 text-sm font-medium rounded-full border ${
                              notification.sentTo === 'All Customers' 
                                ? 'bg-blue-100 text-blue-800 border-blue-200'
                                : 'bg-purple-100 text-purple-800 border-purple-200'
                            }`}>
                              {notification.sentTo}
                            </span>
                          </div>
                          <p className="text-gray-600 mb-3">{notification.message}</p>
                          <div className="flex items-center gap-4 text-sm text-gray-500">
                            <div className="flex items-center gap-1">
                              <Users className="w-4 h-4" />
                              {notification.sentCount} recipients
                            </div>
                            <div className="flex items-center gap-1">
                              <Clock className="w-4 h-4" />
                              {new Date(notification.sentAt).toLocaleString()}
                            </div>
                            {notification.matchName && (
                              <div className="flex items-center gap-1">
                                <Trophy className="w-4 h-4" />
                                {notification.matchName}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          )}

          {/* Settings Tab */}
          {this.state.activeTab === 'settings' && (
            <div className="bg-white rounded-2xl shadow-lg p-8 border border-gray-100">
              <h2 className="text-xl font-bold text-gray-900 mb-6">Organization Settings</h2>
              <div className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Organization Name
                  </label>
                  <input
                    type="text"
                    defaultValue="Delhi Billiards Club"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">
                    Default Venue
                  </label>
                  <input
                    type="text"
                    defaultValue="Delhi Sports Complex"
                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                </div>
                <button className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                  Save Settings
                </button>
              </div>
            </div>
          )}

          {/* Match Details Modal */}
          {this.state.showMatchDetails && this.state.selectedMatch && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
              <div className="bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-96 overflow-y-auto">
                <div className="bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4 rounded-t-2xl">
                  <div className="flex items-center justify-between">
                    <h3 className="text-xl font-bold text-white">{this.state.selectedMatch.name}</h3>
                    <button
                      onClick={() => this.setState({ showMatchDetails: false })}
                      className="text-white hover:text-blue-200 transition-colors"
                    >
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                
                <div className="p-6 space-y-4">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <span className="text-sm font-medium text-gray-500">Game Type</span>
                      <p className="text-gray-900">{this.state.selectedMatch.gameType}</p>
                    </div>
                    <div>
                      <span className="text-sm font-medium text-gray-500">Venue</span>
                      <p className="text-gray-900">{this.state.selectedMatch.venue}</p>
                    </div>
                    <div>
                      <span className="text-sm font-medium text-gray-500">Date & Time</span>
                      <p className="text-gray-900">{new Date(this.state.selectedMatch.date).toLocaleDateString()} at {this.state.selectedMatch.time}</p>
                    </div>
                    <div>
                      <span className="text-sm font-medium text-gray-500">Players</span>
                      <p className="text-gray-900">{this.state.selectedMatch.players}/{this.state.selectedMatch.maxPlayers || this.state.selectedMatch.players}</p>
                    </div>
                  </div>

                  {/* Organizer Info */}
                  {this.state.selectedMatch.organizerName && (
                    <div className="bg-blue-50 p-4 rounded-lg">
                      <span className="text-sm font-medium text-gray-500">Organizer</span>
                      <p className="text-gray-900 font-medium">{this.state.selectedMatch.organizerName}</p>
                      {this.state.selectedMatch.organizerDescription && (
                        <p className="text-sm text-gray-600 mt-1">{this.state.selectedMatch.organizerDescription}</p>
                      )}
                    </div>
                  )}

                  <div className="bg-gray-50 p-4 rounded-lg">
                    <span className="text-sm font-medium text-gray-500">Entry Fee</span>
                    <p className="text-2xl font-bold text-green-600">${this.state.selectedMatch.entryFee}</p>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Notified Users Modal */}
          {this.state.showNotifiedUsers && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
              <div className="bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-96 overflow-y-auto">
                <div className="bg-gradient-to-r from-orange-600 to-red-600 px-6 py-4 rounded-t-2xl">
                  <div className="flex items-center justify-between">
                    <h3 className="text-xl font-bold text-white">Notified Users</h3>
                    <button
                      onClick={() => this.setState({ showNotifiedUsers: false })}
                      className="text-white hover:text-orange-200 transition-colors"
                    >
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                
                <div className="p-6 space-y-4">
                  <div className="bg-orange-50 p-4 rounded-lg">
                    <p className="text-sm text-orange-800">
                      <span className="font-medium">Notification Type:</span> All Registered Customers
                    </p>
                    <p className="text-sm text-orange-800 mt-1">
                      <span className="font-medium">Total Notified:</span> {this.registeredCustomers.length} users
                    </p>
                  </div>

                  <div>
                    <h4 className="font-medium text-gray-900 mb-3">Notified Users List</h4>
                    <div className="space-y-2">
                      {this.registeredCustomers.map(customer => (
                        <div key={customer.id} className="flex items-center justify-between p-3 bg-gray-50 rounded border">
                          <div className="flex items-center gap-3">
                            <img 
                              src={customer.profilePic || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face'} 
                              alt={customer.name}
                              className="w-10 h-10 rounded-full object-cover border-2 border-gray-200"
                            />
                            <div>
                              <div className="font-medium text-gray-900">{customer.name}</div>
                              <div className="text-sm text-gray-600">{customer.email}</div>
                            </div>
                          </div>
                          <div className="text-right">
                            <span className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">
                              {customer.skill}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Send Notification Modal */}
          {this.state.showSendNotificationModal && (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
              <div className="bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="bg-gradient-to-r from-green-600 to-emerald-600 px-6 py-4 rounded-t-2xl">
                  <div className="flex items-center justify-between">
                    <h3 className="text-xl font-bold text-white">Send Notification</h3>
                    <button
                      onClick={() => this.setState({ showSendNotificationModal: false })}
                      className="text-white hover:text-green-200 transition-colors"
                    >
                      <X className="w-6 h-6" />
                    </button>
                  </div>
                </div>
                
                <div className="p-6 space-y-6">
                  {/* Notification Form */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Notification Title *
                      </label>
                      <input
                        type="text"
                        value={this.state.notificationForm.title}
                        onChange={(e) => this.handleNotificationInputChange('title', e.target.value)}
                        placeholder="e.g., Tournament Reminder"
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        Notification Type
                      </label>
                      <select
                        value={this.state.notificationForm.notificationType}
                        onChange={(e) => this.handleNotificationInputChange('notificationType', e.target.value as 'all' | 'selected')}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                      >
                        <option value="all">Notify All Customers</option>
                        <option value="selected">Notify Selected Customers</option>
                      </select>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Message *
                    </label>
                    <textarea
                      value={this.state.notificationForm.message}
                      onChange={(e) => this.handleNotificationInputChange('message', e.target.value)}
                      placeholder="Enter your notification message..."
                      rows={4}
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    />
                  </div>

                  {/* Customer Selection */}
                  {this.state.notificationForm.notificationType === 'selected' && (
                    <div>
                      <div className="flex items-center justify-between mb-4">
                        <h4 className="font-medium text-gray-900">Select Customers</h4>
                        <div className="flex gap-2">
                          <button
                            onClick={this.handleSelectAllCustomers}
                            className="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded hover:bg-blue-200 transition-colors"
                          >
                            Select All
                          </button>
                          <button
                            onClick={this.handleClearCustomerSelection}
                            className="px-3 py-1 bg-gray-100 text-gray-800 text-sm rounded hover:bg-gray-200 transition-colors"
                          >
                            Clear All
                          </button>
                        </div>
                      </div>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                        {this.registeredCustomers.map((customer) => (
                          <div key={customer.id} className="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                            <input
                              type="checkbox"
                              id={`customer-${customer.id}`}
                              checked={this.state.notificationForm.selectedCustomers.includes(customer.id)}
                              onChange={(e) => this.handleCustomerSelection(customer.id, e.target.checked)}
                              className="w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"
                            />
                            <label htmlFor={`customer-${customer.id}`} className="ml-3 flex-1 cursor-pointer">
                              <div className="flex items-center gap-3">
                                <img 
                                  src={customer.profilePic || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face'} 
                                  alt={customer.name}
                                  className="w-10 h-10 rounded-full object-cover border-2 border-gray-200"
                                />
                                <div>
                                  <div className="font-medium text-gray-900">{customer.name}</div>
                                  <div className="text-sm text-gray-600">{customer.email}</div>
                                  <span className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">
                                    {customer.skill}
                                  </span>
                                </div>
                              </div>
                            </label>
                          </div>
                        ))}
                      </div>
                      
                      <div className="mt-3 text-sm text-gray-600">
                        Selected: {this.state.notificationForm.selectedCustomers.length} of {this.registeredCustomers.length} customers
                      </div>
                    </div>
                  )}

                  {/* Preview */}
                  {this.state.notificationForm.notificationType === 'all' && (
                    <div className="bg-green-50 p-4 rounded-lg">
                      <h4 className="font-medium text-green-900 mb-2">Notification Preview</h4>
                      <p className="text-sm text-green-800">
                        <span className="font-medium">Recipients:</span> All {this.registeredCustomers.length} registered customers
                      </p>
                      <p className="text-sm text-green-800 mt-1">
                        <span className="font-medium">Title:</span> {this.state.notificationForm.title || 'No title'}
                      </p>
                      <p className="text-sm text-green-800 mt-1">
                        <span className="font-medium">Message:</span> {this.state.notificationForm.message || 'No message'}
                      </p>
                    </div>
                  )}

                  {/* Action Buttons */}
                  <div className="flex justify-end gap-4 pt-4 border-t border-gray-200">
                    <button
                      onClick={() => this.setState({ showSendNotificationModal: false })}
                      className="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                    >
                      Cancel
                    </button>
                    <button
                      onClick={this.handleSendNotification}
                      disabled={!this.state.notificationForm.title || !this.state.notificationForm.message || 
                               (this.state.notificationForm.notificationType === 'selected' && this.state.notificationForm.selectedCustomers.length === 0)}
                      className="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-8 py-3 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <AlertCircle className="w-5 h-5" />
                      Send Notification
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>


        {/* Tournament Details Modal */}
        {this.state.showMatchDetailsModal && this.state.selectedMatch && (
          <div 
            className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
            onClick={this.handleCloseMatchDetailsModal}
          >
            <div 
              className="bg-white rounded-2xl shadow-2xl max-w-full w-full h-[95vh] flex flex-col"
              onClick={(e) => e.stopPropagation()}
            >
              {/* Modal Header */}
              <div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 rounded-t-2xl relative flex-shrink-0">
                <button
                  onClick={this.handleCloseMatchDetailsModal}
                  className="absolute top-4 right-4 text-white hover:text-blue-200 transition-colors p-2 rounded-full hover:bg-white hover:bg-opacity-20 z-10"
                >
                  <X className="w-6 h-6" />
                </button>
                
                {/* Tournament Info and Conducted By Profile - One Line */}
                <div className="flex items-center justify-between pr-16">
                  <div className="flex-1">
                    <h1 className="text-3xl font-bold mb-2"> {this.state.selectedMatch.name}</h1>
                    <div className="flex items-center gap-6 text-blue-100 text-sm">
                      <div className="flex items-center gap-2">
                        <Calendar className="w-4 h-4" />
                        <span>{new Date(this.state.selectedMatch.date).toLocaleDateString()}</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <Clock className="w-4 h-4" />
                        <span>{this.state.selectedMatch.startTime}</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <Clock className="w-4 h-4" />
                        <span>{this.state.selectedMatch.endTime}</span>
                      </div>
                    </div>
                  </div>
                  
                  {/* Conducted By Profile */}
                  {this.state.selectedMatch.conductedByProfile && (
                    <div 
                      className="flex items-center gap-3 bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4 border border-white border-opacity-20 mr-2 cursor-pointer hover:bg-opacity-20 transition-all duration-200"
                      onClick={() => this.handleOpenProfileModal(this.state.selectedMatch.conductedByProfile)}
                    >
                      <div className="relative">
                        <img 
                          src={this.state.selectedMatch.conductedByProfile.profilePic || this.state.selectedMatch.conductedByProfile.logo} 
                          alt={this.state.selectedMatch.conductedByProfile.name}
                          className="w-12 h-12 rounded-full object-cover border-2 border-white border-opacity-30"
                        />
                        <div className="absolute -bottom-1 -right-1 w-5 h-5 bg-blue-400 rounded-full flex items-center justify-center">
                          <span className="text-xs font-bold text-white"></span>
                        </div>
                      </div>
                      <div className="text-right">
                        <h4 className="font-semibold text-white text-sm">{this.state.selectedMatch.conductedByProfile.name}</h4>
                        <p className="text-blue-200 text-xs">{this.state.selectedMatch.conductedByProfile.description}</p>
                        <p className="text-blue-300 text-xs">{this.state.selectedMatch.conductedByProfile.contact}</p>
                      </div>
                    </div>
                  )}
                </div>

                {/* Top 4 Players in Header */}
                {this.state.selectedMatch.topPlayers && (
                  <div className="mt-6 pt-4 border-t border-blue-400 border-opacity-30">
                    <h3 className="text-lg font-semibold text-white mb-4 text-center"> Top 4 Champions</h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                      {/* Winner */}
                      <div 
                        className="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-3 border border-white border-opacity-20 cursor-pointer hover:bg-opacity-20 transition-all duration-200"
                        onClick={() => this.handleOpenProfileModal(this.state.selectedMatch.topPlayers.winner)}
                      >
                        <div className="flex flex-col items-center text-center">
                          <div className="relative mb-2">
                            <img 
                              src={this.state.selectedMatch.topPlayers.winner.avatar} 
                              alt={this.state.selectedMatch.topPlayers.winner.name}
                              className="w-12 h-12 rounded-full object-cover border-2 border-yellow-400"
                            />
                            <div className="absolute -top-1 -right-1 w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center">
                              <span className="text-xs font-bold text-white">1</span>
                            </div>
                          </div>
                          <h4 className="font-semibold text-white text-sm">{this.state.selectedMatch.topPlayers.winner.name}</h4>
                          <p className="text-blue-200 text-xs"> Winner</p>
                          <p className="text-yellow-300 text-xs font-bold">{this.state.selectedMatch.topPlayers.winner.prize}</p>
                        </div>
                      </div>

                      {/* Runner Up */}
                      <div 
                        className="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-3 border border-white border-opacity-20 cursor-pointer hover:bg-opacity-20 transition-all duration-200"
                        onClick={() => this.handleOpenProfileModal(this.state.selectedMatch.topPlayers.runnerUp)}
                      >
                        <div className="flex flex-col items-center text-center">
                          <div className="relative mb-2">
                            <img 
                              src={this.state.selectedMatch.topPlayers.runnerUp.avatar} 
                              alt={this.state.selectedMatch.topPlayers.runnerUp.name}
                              className="w-12 h-12 rounded-full object-cover border-2 border-gray-300"
                            />
                            <div className="absolute -top-1 -right-1 w-5 h-5 bg-gray-400 rounded-full flex items-center justify-center">
                              <span className="text-xs font-bold text-white">2</span>
                            </div>
                          </div>
                          <h4 className="font-semibold text-white text-sm">{this.state.selectedMatch.topPlayers.runnerUp.name}</h4>
                          <p className="text-blue-200 text-xs"> Runner-up</p>
                          <p className="text-yellow-300 text-xs font-bold">{this.state.selectedMatch.topPlayers.runnerUp.prize}</p>
                        </div>
                      </div>

                      {/* Third Place */}
                      <div 
                        className="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-3 border border-white border-opacity-20 cursor-pointer hover:bg-opacity-20 transition-all duration-200"
                        onClick={() => this.handleOpenProfileModal(this.state.selectedMatch.topPlayers.thirdPlace)}
                      >
                        <div className="flex flex-col items-center text-center">
                          <div className="relative mb-2">
                            <img 
                              src={this.state.selectedMatch.topPlayers.thirdPlace.avatar} 
                              alt={this.state.selectedMatch.topPlayers.thirdPlace.name}
                              className="w-12 h-12 rounded-full object-cover border-2 border-orange-400"
                            />
                            <div className="absolute -top-1 -right-1 w-5 h-5 bg-orange-400 rounded-full flex items-center justify-center">
                              <span className="text-xs font-bold text-white">3</span>
                            </div>
                          </div>
                          <h4 className="font-semibold text-white text-sm">{this.state.selectedMatch.topPlayers.thirdPlace.name}</h4>
                          <p className="text-blue-200 text-xs"> 3rd Place</p>
                          <p className="text-yellow-300 text-xs font-bold">{this.state.selectedMatch.topPlayers.thirdPlace.prize}</p>
                        </div>
                      </div>

                      {/* Fourth Place */}
                      <div 
                        className="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-3 border border-white border-opacity-20 cursor-pointer hover:bg-opacity-20 transition-all duration-200"
                        onClick={() => this.handleOpenProfileModal(this.state.selectedMatch.topPlayers.fourthPlace)}
                      >
                        <div className="flex flex-col items-center text-center">
                          <div className="relative mb-2">
                            <img 
                              src={this.state.selectedMatch.topPlayers.fourthPlace.avatar} 
                              alt={this.state.selectedMatch.topPlayers.fourthPlace.name}
                              className="w-12 h-12 rounded-full object-cover border-2 border-blue-400"
                            />
                            <div className="absolute -top-1 -right-1 w-5 h-5 bg-blue-400 rounded-full flex items-center justify-center">
                              <span className="text-xs font-bold text-white">4</span>
                            </div>
                          </div>
                          <h4 className="font-semibold text-white text-sm">{this.state.selectedMatch.topPlayers.fourthPlace.name}</h4>
                          <p className="text-blue-200 text-xs"> 4th Place</p>
                          <p className="text-yellow-300 text-xs font-bold">{this.state.selectedMatch.topPlayers.fourthPlace.prize}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              {/* Tabs */}
              <div className="flex border-b border-gray-200 flex-shrink-0">
                <button
                  onClick={() => this.setState({ modalActiveTab: 'players' })}
                  className={`flex-1 py-4 px-6 text-center font-medium transition-colors ${
                    this.state.modalActiveTab === 'players'
                      ? 'bg-blue-50 text-blue-600 border-b-2 border-blue-600'
                      : 'text-gray-600 hover:text-gray-800 hover:bg-gray-50'
                  }`}
                >
                  <Users className="w-5 h-5 inline-block mr-2" />
                  All Players ({this.state.selectedMatch.registeredPlayers?.length || 0})
                </button>
                <button
                  onClick={() => this.setState({ modalActiveTab: 'tournament' })}
                  className={`flex-1 py-4 px-6 text-center font-medium transition-colors ${
                    this.state.modalActiveTab === 'tournament'
                      ? 'bg-blue-50 text-blue-600 border-b-2 border-blue-600'
                      : 'text-gray-600 hover:text-gray-800 hover:bg-gray-50'
                  }`}
                >
                  <Trophy className="w-5 h-5 inline-block mr-2" />
                  Tournament Bracket
                </button>
              </div>

              {/* Modal Content - Scrollable */}
              <div className="flex-1 overflow-y-auto" style={{ maxHeight: 'calc(95vh - 200px)' }}>
                {/* Tab Content */}
                <div className="p-6">
                  {this.state.modalActiveTab === 'players' && (
                    <div>
                      <h2 className="text-2xl font-semibold mb-6 text-gray-800">Tournament Participants</h2>
                      <div className="mb-4 p-4 bg-blue-100 rounded-lg">
                        <p className="text-sm text-blue-800">Scroll test: You should be able to scroll through all {this.state.selectedMatch.registeredPlayers?.length || 0} players below.</p>
                      </div>
                      <div className="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                        {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers.map((player) => (
                          <div 
                            key={player.id} 
                            className="bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer hover:border-blue-300"
                            onClick={() => this.handleOpenProfileModal(player)}
                          >
                            <div className="flex items-center justify-between mb-3">
                              <div className="relative">
                                <img
                                  src={player.profilePic}
                                  alt={player.name}
                                  className="w-10 h-10 rounded-full object-cover border-2 border-blue-400"
                                />
                                <div className="absolute -bottom-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
                                  {player.finalPosition || player.id}
                                </div>
                              </div>
                              <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                player.skill === 'Advanced' ? 'bg-purple-100 text-purple-800' :
                                player.skill === 'Intermediate' ? 'bg-green-100 text-green-800' :
                                'bg-gray-100 text-gray-600'
                              }`}>
                                {player.skill}
                              </span>
                            </div>
                            <h3 className="font-semibold text-gray-800 mb-2">{player.name}</h3>
                            <div className="text-sm text-gray-600 space-y-1">
                              <div className="flex justify-between">
                                <span>Email:</span>
                                <span className="font-medium text-blue-600">{player.email}</span>
                              </div>
                              <div className="flex justify-between">
                                <span>Position:</span>
                                <span className="font-medium text-green-600">#{player.finalPosition || 'N/A'}</span>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                      
                      {/* Debug content to ensure scrolling */}
                      <div className="mt-8 p-4 bg-green-100 rounded-lg">
                        <p className="text-sm text-green-800">End of player list - If you can see this, scrolling is working!</p>
                      </div>
                    </div>
                  )}

                  {this.state.modalActiveTab === 'tournament' && (
                    <div>
                      <h2 className="text-2xl font-semibold mb-6 text-gray-800">Tournament Bracket</h2>
                      <div className="overflow-x-auto">
                        <div className="flex space-x-6 min-w-max pb-4">
                          
                          {/* Round 1 */}
                          <div className="flex-shrink-0 w-64">
                            <h3 className="text-lg font-semibold mb-4 text-center bg-blue-100 text-blue-800 py-2 rounded-lg">
                              Round 1 (30 Players)
                            </h3>
                            {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers.slice(0, 16).map((player, index) => (
                              <div key={`r1-${index}`} className="bg-white border-2 rounded-lg p-3 mb-3 shadow-sm hover:shadow-md transition-shadow border-gray-200">
                                <div className="text-xs text-gray-500 mb-2 font-semibold">
                                  Match {index + 1}
                                </div>
                                <div className="space-y-2">
                                  <div 
                                    className="flex items-center justify-between p-2 rounded bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors"
                                    onClick={() => this.handleOpenProfileModal(player)}
                                  >
                                    <div className="flex items-center gap-2">
                                      <img
                                        src={player.profilePic}
                                        alt={player.name}
                                        className="w-6 h-6 rounded-full object-cover border border-gray-300"
                                      />
                                      <span className="text-sm font-medium">{player.name}</span>
                                    </div>
                                    {player.finalPosition <= 2 && <span className="text-green-600 font-bold"></span>}
                                  </div>
                                  {index % 2 === 1 && (
                                    <>
                                      <div className="text-center text-gray-400 text-xs">VS</div>
                                      <div 
                                        className="flex items-center justify-between p-2 rounded bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors"
                                        onClick={() => this.handleOpenProfileModal(this.state.selectedMatch?.registeredPlayers?.[index - 1])}
                                      >
                                        <div className="flex items-center gap-2">
                                          <img
                                            src={this.state.selectedMatch?.registeredPlayers?.[index - 1]?.profilePic || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face'}
                                            alt={this.state.selectedMatch?.registeredPlayers?.[index - 1]?.name || 'Player'}
                                            className="w-6 h-6 rounded-full object-cover border border-gray-300"
                                          />
                                          <span className="text-sm font-medium">{this.state.selectedMatch?.registeredPlayers?.[index - 1]?.name || 'Player'}</span>
                                        </div>
                                        {((this.state.selectedMatch?.registeredPlayers?.[index - 1]?.finalPosition || 0) <= 2) && <span className="text-green-600 font-bold"></span>}
                                      </div>
                                    </>
                                  )}
                                </div>
                                {player.finalPosition <= 2 && (
                                  <div className="mt-2 text-center">
                                    <span className="text-xs bg-green-600 text-white px-2 py-1 rounded-full">
                                      Winner: {player.name}
                                    </span>
                                  </div>
                                )}
                              </div>
                            ))}
                          </div>

                          {/* Arrow */}
                          <div className="flex items-center justify-center flex-shrink-0">
                            <ChevronRight className="w-6 h-6 text-gray-400" />
                          </div>

                          {/* Round 2 */}
                          <div className="flex-shrink-0 w-64">
                            <h3 className="text-lg font-semibold mb-4 text-center bg-green-100 text-green-800 py-2 rounded-lg">
                              Round 2 (16 Players)
                            </h3>
                            {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers
                              .filter(player => player.finalPosition <= 16)
                              .sort((a, b) => a.finalPosition - b.finalPosition)
                              .slice(0, 8)
                              .map((player, index) => (
                                <div key={`r2-${index}`} className="bg-white border-2 rounded-lg p-3 mb-3 shadow-sm hover:shadow-md transition-shadow border-gray-200">
                                  <div className="text-xs text-gray-500 mb-2 font-semibold">
                                    Match {index + 1}
                                  </div>
                                  <div className="space-y-2">
                                    <div 
                                      className="flex items-center justify-between p-2 rounded bg-green-50 cursor-pointer hover:bg-green-100 transition-colors"
                                      onClick={() => this.handleOpenProfileModal(player)}
                                    >
                                      <div className="flex items-center gap-2">
                                        <img
                                          src={player.profilePic}
                                          alt={player.name}
                                          className="w-6 h-6 rounded-full object-cover border border-gray-300"
                                        />
                                        <span className="text-sm font-medium">{player.name}</span>
                                      </div>
                                      {player.finalPosition <= 2 && <span className="text-green-600 font-bold"></span>}
                                    </div>
                                    <div className="text-center text-gray-400 text-xs">VS</div>
                                    <div className="flex items-center justify-between p-2 rounded bg-green-50">
                                      <span className="text-sm font-medium">Opponent</span>
                                    </div>
                                  </div>
                                  {player.finalPosition <= 2 && (
                                    <div className="mt-2 text-center">
                                      <span className="text-xs bg-green-600 text-white px-2 py-1 rounded-full">
                                        Winner: {player.name}
                                      </span>
                                    </div>
                                  )}
                                </div>
                              ))}
                          </div>

                          {/* Arrow */}
                          <div className="flex items-center justify-center flex-shrink-0">
                            <ChevronRight className="w-6 h-6 text-gray-400" />
                          </div>

                          {/* Round 3 */}
                          <div className="flex-shrink-0 w-64">
                            <h3 className="text-lg font-semibold mb-4 text-center bg-yellow-100 text-yellow-800 py-2 rounded-lg">
                              Round 3 (8 Players)
                            </h3>
                            {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers
                              .filter(player => player.finalPosition <= 8)
                              .sort((a, b) => a.finalPosition - b.finalPosition)
                              .slice(0, 4)
                              .map((player, index) => (
                                <div key={`r3-${index}`} className="bg-white border-2 rounded-lg p-3 mb-3 shadow-sm hover:shadow-md transition-shadow border-gray-200">
                                  <div className="text-xs text-gray-500 mb-2 font-semibold">
                                    Match {index + 1}
                                  </div>
                                  <div className="space-y-2">
                                    <div 
                                      className="flex items-center justify-between p-2 rounded bg-yellow-50 cursor-pointer hover:bg-yellow-100 transition-colors"
                                      onClick={() => this.handleOpenProfileModal(player)}
                                    >
                                      <div className="flex items-center gap-2">
                                        <img
                                          src={player.profilePic}
                                          alt={player.name}
                                          className="w-6 h-6 rounded-full object-cover border border-gray-300"
                                        />
                                        <span className="text-sm font-medium">{player.name}</span>
                                      </div>
                                      {player.finalPosition <= 4 && <span className="text-green-600 font-bold"></span>}
                                    </div>
                                    <div className="text-center text-gray-400 text-xs">VS</div>
                                    <div className="flex items-center justify-between p-2 rounded bg-yellow-50">
                                      <span className="text-sm font-medium">Opponent</span>
                                    </div>
                                  </div>
                                  {player.finalPosition <= 4 && (
                                    <div className="mt-2 text-center">
                                      <span className="text-xs bg-green-600 text-white px-2 py-1 rounded-full">
                                        Winner: {player.name}
                                      </span>
                                    </div>
                                  )}
                                </div>
                              ))}
                          </div>

                          {/* Arrow */}
                          <div className="flex items-center justify-center flex-shrink-0">
                            <ChevronRight className="w-6 h-6 text-gray-400" />
                          </div>

                          {/* Semifinals */}
                          <div className="flex-shrink-0 w-64">
                            <h3 className="text-lg font-semibold mb-4 text-center bg-purple-100 text-purple-800 py-2 rounded-lg">
                              Semifinals (4 Players)
                            </h3>
                            {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers
                              .filter(player => player.finalPosition <= 4)
                              .sort((a, b) => a.finalPosition - b.finalPosition)
                              .slice(0, 2)
                              .map((player, index) => (
                                <div key={`sf-${index}`} className="bg-white border-2 rounded-lg p-3 mb-3 shadow-sm hover:shadow-md transition-shadow border-gray-200">
                                  <div className="text-xs text-gray-500 mb-2 font-semibold">
                                    Match {index + 1}
                                  </div>
                                  <div className="space-y-2">
                                    <div 
                                      className="flex items-center justify-between p-2 rounded bg-purple-50 cursor-pointer hover:bg-purple-100 transition-colors"
                                      onClick={() => this.handleOpenProfileModal(player)}
                                    >
                                      <div className="flex items-center gap-2">
                                        <img
                                          src={player.profilePic}
                                          alt={player.name}
                                          className="w-6 h-6 rounded-full object-cover border border-gray-300"
                                        />
                                        <span className="text-sm font-medium">{player.name}</span>
                                      </div>
                                      {player.finalPosition <= 2 && <span className="text-green-600 font-bold"></span>}
                                    </div>
                                    <div className="text-center text-gray-400 text-xs">VS</div>
                                    <div className="flex items-center justify-between p-2 rounded bg-purple-50">
                                      <span className="text-sm font-medium">Opponent</span>
                                    </div>
                                  </div>
                                  {player.finalPosition <= 2 && (
                                    <div className="mt-2 text-center">
                                      <span className="text-xs bg-green-600 text-white px-2 py-1 rounded-full">
                                        Winner: {player.name}
                                      </span>
                                    </div>
                                  )}
                                </div>
                              ))}
                          </div>

                          {/* Arrow */}
                          <div className="flex items-center justify-center flex-shrink-0">
                            <ChevronRight className="w-6 h-6 text-gray-400" />
                          </div>

                          {/* Final Rankings */}
                          <div className="flex-shrink-0 w-64">
                            <h3 className="text-lg font-semibold mb-4 text-center bg-gradient-to-r from-yellow-400 to-yellow-600 text-white py-2 rounded-lg">
                               Final Rankings
                            </h3>
                            
                            {this.state.selectedMatch.registeredPlayers && this.state.selectedMatch.registeredPlayers
                              .filter(player => player.finalPosition <= 10)
                              .sort((a, b) => a.finalPosition - b.finalPosition)
                              .map((player) => (
                                <div key={`ranking-${player.id}`} className={`${
                                  player.finalPosition === 1 
                                    ? 'bg-gradient-to-br from-yellow-50 to-yellow-100 border-2 border-yellow-400 shadow-md' 
                                    : player.finalPosition === 2 
                                    ? 'bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-400 shadow-md' 
                                    : player.finalPosition === 3
                                    ? 'bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-500 shadow-md'
                                    : 'bg-white border border-gray-300 shadow-sm'
                                } rounded-lg p-4 mb-3`}>
                                  <div className="flex items-center justify-between">
                                    <div className="flex items-center space-x-3">
                                      <div className={`w-8 h-8 ${
                                        player.finalPosition === 1 ? 'bg-yellow-500' :
                                        player.finalPosition === 2 ? 'bg-gray-500' :
                                        player.finalPosition === 3 ? 'bg-amber-600' :
                                        'bg-blue-500'
                                      } text-white rounded-full flex items-center justify-center font-bold text-sm`}>
                                        {player.finalPosition}
                                      </div>
                                      <div>
                                        <p className="font-bold text-gray-800">{player.name}</p>
                                        <p className={`text-xs font-medium ${
                                          player.finalPosition === 1 ? 'text-yellow-700' :
                                          player.finalPosition === 2 ? 'text-gray-600' :
                                          player.finalPosition === 3 ? 'text-amber-700' :
                                          'text-blue-600'
                                        }`}>
                                          {player.finalPosition === 1 ? ' Champion' : 
                                           player.finalPosition === 2 ? ' Runner-up' : 
                                           player.finalPosition === 3 ? ' 3rd Place' :
                                           `#${player.finalPosition} Place`}
                                        </p>
                                      </div>
                                    </div>
                                    <Trophy className={`w-6 h-6 ${
                                      player.finalPosition === 1 ? 'text-yellow-600' :
                                      player.finalPosition === 2 ? 'text-gray-500' :
                                      player.finalPosition === 3 ? 'text-amber-500' :
                                      'text-blue-400'
                                    }`} />
                                  </div>
                                </div>
                              ))}
                          </div>
                        </div>
                      </div>
                      
                      {/* Legend */}
                      <div className="mt-8 bg-gray-50 p-4 rounded-lg">
                        <h4 className="font-semibold mb-2 text-gray-700">Tournament Progress:</h4>
                        <div className="flex flex-wrap gap-4 text-sm">
                          <div className="flex items-center">
                            <div className="w-4 h-4 bg-green-100 border border-green-300 rounded mr-2"></div>
                            <span>Winner</span>
                          </div>
                          <div className="flex items-center">
                            <div className="w-4 h-4 bg-gray-50 rounded mr-2"></div>
                            <span>Eliminated</span>
                          </div>
                          <div className="flex items-center">
                            <span className="text-green-600 font-bold mr-2"></span>
                            <span>Match Winner</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Profile Details Modal */}
        {this.state.showProfileModal && this.state.selectedProfile && (
          <div 
            className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
            onClick={this.handleCloseProfileModal}
          >
            <div 
              className="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto"
              onClick={(e) => e.stopPropagation()}
            >
              {/* Modal Header */}
              <div className="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 rounded-t-2xl relative">
                <button
                  onClick={this.handleCloseProfileModal}
                  className="absolute top-4 right-4 text-white hover:text-purple-200 transition-colors p-2 rounded-full hover:bg-white hover:bg-opacity-20"
                >
                  <X className="w-6 h-6" />
                </button>
                
                <div className="flex flex-col items-center text-center">
                  <div className="relative mb-4">
                    <img 
                      src={this.state.selectedProfile.avatar || this.state.selectedProfile.profilePic} 
                      alt={this.state.selectedProfile.name}
                      className="w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg"
                    />
                    <div className="absolute -bottom-2 -right-2 w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center border-2 border-white">
                      <span className="text-sm font-bold text-white">{this.state.selectedProfile.position || this.state.selectedProfile.finalPosition || this.state.selectedProfile.id}</span>
                    </div>
                  </div>
                  <h1 className="text-2xl font-bold mb-2">{this.state.selectedProfile.name}</h1>
              <p className="text-purple-200 text-sm">{this.state.selectedProfile.email || this.state.selectedProfile.contact}</p>
              {(this.state.selectedProfile.position || this.state.selectedProfile.finalPosition || this.state.selectedProfile.skill) && (
                <div className="mt-2">
                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                    this.state.selectedProfile.position === 1 ? 'bg-yellow-100 text-yellow-800' :
                    this.state.selectedProfile.position === 2 ? 'bg-gray-100 text-gray-800' :
                    this.state.selectedProfile.position === 3 ? 'bg-orange-100 text-orange-800' :
                    this.state.selectedProfile.position === 4 ? 'bg-blue-100 text-blue-800' :
                    this.state.selectedProfile.position === 'Tournament Director' ? 'bg-purple-100 text-purple-800' :
                    this.state.selectedProfile.skill === 'Pro' ? 'bg-purple-100 text-purple-800' :
                    this.state.selectedProfile.skill === 'Expert' ? 'bg-red-100 text-red-800' :
                    this.state.selectedProfile.skill === 'Advanced' ? 'bg-blue-100 text-blue-800' :
                    this.state.selectedProfile.skill === 'Intermediate' ? 'bg-green-100 text-green-800' :
                    'bg-gray-100 text-gray-800'
                  }`}>
                    {this.state.selectedProfile.position === 1 ? ' Winner' :
                     this.state.selectedProfile.position === 2 ? ' Runner-up' :
                     this.state.selectedProfile.position === 3 ? ' 3rd Place' :
                     this.state.selectedProfile.position === 4 ? ' 4th Place' :
                     this.state.selectedProfile.position === 'Tournament Director' ? ' Tournament Director' :
                     this.state.selectedProfile.skill ? ` ${this.state.selectedProfile.skill}` :
                     `Position #${this.state.selectedProfile.finalPosition || this.state.selectedProfile.id}`}
                  </span>
                </div>
              )}
                </div>
              </div>

              {/* Modal Content */}
              <div className="p-6">
                <div className="space-y-6">
                  {/* Position & Prize */}
                  <div className="bg-gradient-to-r from-yellow-50 to-orange-50 p-4 rounded-lg border border-yellow-200">
                    <div className="flex items-center justify-between">
                      <div>
                        <h3 className="font-semibold text-gray-900 mb-1">
                          {this.state.selectedProfile.position === 'Tournament Director' ? 'Role & Position' : 
                           this.state.selectedProfile.position || this.state.selectedProfile.finalPosition ? 'Tournament Position' : 'Player Information'}
                        </h3>
                        <div className="flex items-center gap-2">
                          {this.state.selectedProfile.position === 1 && <span className="text-2xl"></span>}
                          {this.state.selectedProfile.position === 2 && <span className="text-2xl"></span>}
                          {this.state.selectedProfile.position === 3 && <span className="text-2xl"></span>}
                          {this.state.selectedProfile.position === 4 && <span className="text-2xl"></span>}
                          {this.state.selectedProfile.position === 'Tournament Director' && <span className="text-2xl"></span>}
                          {this.state.selectedProfile.skill && !this.state.selectedProfile.position && <span className="text-2xl"></span>}
                          <span className="text-lg font-bold text-gray-800">
                            {this.state.selectedProfile.position === 1 ? 'Winner' :
                             this.state.selectedProfile.position === 2 ? 'Runner-up' :
                             this.state.selectedProfile.position === 3 ? '3rd Place' :
                             this.state.selectedProfile.position === 4 ? '4th Place' :
                             this.state.selectedProfile.position === 'Tournament Director' ? 'Tournament Director' :
                             this.state.selectedProfile.skill ? `${this.state.selectedProfile.skill} Player` :
                             `Position #${this.state.selectedProfile.finalPosition || this.state.selectedProfile.id}`}
                          </span>
                        </div>
                      </div>
                      {this.state.selectedProfile.prize && (
                        <div className="text-right">
                          <h3 className="font-semibold text-gray-900 mb-1">Prize Money</h3>
                          <div className="text-2xl font-bold text-green-600">{this.state.selectedProfile.prize}</div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Skill Level */}
                  <div className="bg-gray-50 p-4 rounded-lg">
                    <h3 className="font-semibold text-gray-900 mb-2">
                      {this.state.selectedProfile.position === 'Tournament Director' ? 'Experience Level' : 
                       this.state.selectedProfile.skill ? 'Skill Level' : 'Skill Level'}
                    </h3>
                    <div className="flex items-center gap-2">
                      <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                        (this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill) === 'Advanced' ? 'bg-purple-100 text-purple-800' :
                        (this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill) === 'Intermediate' ? 'bg-green-100 text-green-800' :
                        (this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill) === 'Expert' ? 'bg-red-100 text-red-800' :
                        (this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill) === 'Pro' ? 'bg-blue-100 text-blue-800' :
                        'bg-gray-100 text-gray-800'
                      }`}>
                        {this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill}
                      </span>
                    </div>
                  </div>

                  {/* Contact Information */}
                  <div className="bg-blue-50 p-4 rounded-lg">
                    <h3 className="font-semibold text-gray-900 mb-3">
                      {this.state.selectedProfile.position === 'Tournament Director' ? 'Organization Contact' : 'Contact Information'}
                    </h3>
                    <div className="space-y-2">
                      {this.state.selectedProfile.email && (
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                            <span className="text-blue-600 text-sm"></span>
                          </div>
                          <span className="text-gray-700">{this.state.selectedProfile.email}</span>
                        </div>
                      )}
                      {this.state.selectedProfile.contact && (
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                            <span className="text-green-600 text-sm"></span>
                          </div>
                          <span className="text-gray-700">{this.state.selectedProfile.contact}</span>
                        </div>
                      )}
                      {this.state.selectedProfile.website && (
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                            <span className="text-purple-600 text-sm"></span>
                          </div>
                          <span className="text-gray-700">{this.state.selectedProfile.website}</span>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Organization Information (for Tournament Directors) */}
                  {this.state.selectedProfile.position === 'Tournament Director' && (
                    <div className="bg-purple-50 p-4 rounded-lg">
                      <h3 className="font-semibold text-gray-900 mb-3">About the Organization</h3>
                      <div className="space-y-2">
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                            <span className="text-purple-600 text-sm"></span>
                          </div>
                          <span className="text-gray-700">{this.state.selectedProfile.name}</span>
                        </div>
                        {this.state.selectedProfile.description && (
                          <div className="flex items-center gap-3">
                            <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                              <span className="text-blue-600 text-sm"></span>
                            </div>
                            <span className="text-gray-700">{this.state.selectedProfile.description}</span>
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  {/* Tournament Stats */}
                  <div className="bg-green-50 p-4 rounded-lg">
                    <h3 className="font-semibold text-gray-900 mb-3">
                      {this.state.selectedProfile.position === 'Tournament Director' ? 'Director Profile' : 
                       this.state.selectedProfile.position || this.state.selectedProfile.finalPosition ? 'Tournament Performance' : 'Player Profile'}
                    </h3>
                    <div className="grid grid-cols-2 gap-4">
                      <div className="text-center">
                        <div className="text-2xl font-bold text-green-600">
                          {this.state.selectedProfile.position === 'Tournament Director' ? '' : 
                           this.state.selectedProfile.position || this.state.selectedProfile.finalPosition ? (this.state.selectedProfile.position || this.state.selectedProfile.finalPosition || this.state.selectedProfile.id) :
                           this.state.selectedProfile.id}
                        </div>
                        <div className="text-sm text-gray-600">
                          {this.state.selectedProfile.position === 'Tournament Director' ? 'Position' : 
                           this.state.selectedProfile.position || this.state.selectedProfile.finalPosition ? 'Final Position' : 'Player ID'}
                        </div>
                      </div>
                      <div className="text-center">
                        <div className="text-lg font-bold text-green-600">{this.state.selectedProfile.skillLevel || this.state.selectedProfile.skill}</div>
                        <div className="text-sm text-gray-600">
                          {this.state.selectedProfile.position === 'Tournament Director' ? 'Experience' : 'Skill Level'}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>
    );
  }
}
